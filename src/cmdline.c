/*
  File autogenerated by gengetopt version 2.19rc
  generated with the following command:
  gengetopt -C 

  The developers of gengetopt consider the fixed text that goes in all
  gengetopt output files to be in the public domain:
  we make no copyright claims on it.
*/

/* If we use autoconf.  */
#ifdef HAVE_CONFIG_H
#include "config.h"
#endif

#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#include "getopt.h"

#include "cmdline.h"

const char *gengetopt_args_info_purpose = "";

const char *gengetopt_args_info_usage = "Usage: " CMDLINE_PARSER_PACKAGE " [OPTIONS]...";

const char *gengetopt_args_info_help[] = {
  "  -h, --help                    Print help and exit",
  "  -V, --version                 Print version and exit",
  "  -f, --fg                      Run in foreground  (default=off)",
  "  -d, --debug                   Run in debug mode  (default=off)",
  "      --debugfacility=INT       Which modules to print debug messages for  \n                                  (default=`1')",
  "      --logfacility=INT         Which modules to print debug messages for  \n                                  (default=`-1')",
  "  -c, --conf=STRING             Read configuration file  \n                                  (default=`/etc/chilli.conf')",
  "      --interval=INT            Re-read configuration file at this interval  \n                                  (default=`3600')",
  "      --pidfile=STRING          Filename of process id file  \n                                  (default=`/var/run/chilli.pid')",
  "      --statedir=STRING         Directory of nonvolatile data  \n                                  (default=`/var/lib/chilli/')",
  "  -n, --net=STRING              Network  (default=`192.168.182.0/24')",
  "      --dhcpstart=INT           Network DHCP Starting IP  (default=`10')",
  "      --dhcpend=INT             Network DHCP Ending IP  (default=`254')",
  "      --dynip=STRING            Dynamic IP address pool",
  "      --statip=STRING           Static IP address pool",
  "      --dns1=STRING             Primary DNS server IP address",
  "      --dns2=STRING             Secondary DNS server IP address",
  "      --domain=STRING           Domain to use for DNS lookups  \n                                  (default=`coova.org')",
  "      --ipup=STRING             Script to run after link-up",
  "      --ipdown=STRING           Script to run after link-down",
  "      --conup=STRING            Script to run after user logon",
  "      --condown=STRING          Script to run after user logoff",
  "      --txqlen=INT              TX Queue length for tun interface (linux only)  \n                                  (default=`100')",
  "      --radiuslisten=STRING     IP address to send from",
  "      --radiusserver1=STRING    IP address of radius server 1",
  "      --radiusserver2=STRING    IP address of radius server 2",
  "      --radiusauthport=INT      Authentication UDP port of radius server  \n                                  (default=`1812')",
  "      --radiusacctport=INT      Accounting UDP port of radius server  \n                                  (default=`1813')",
  "      --radiussecret=STRING     Radius shared secret",
  "      --radiusnasid=STRING      Radius NAS-Identifier  (default=`nas01')",
  "      --radiuslocationid=STRING WISPr Location ID",
  "      --radiuslocationname=STRING\n                                WISPr Location Name",
  "      --radiusnasporttype=INT   Radius NAS-Port-Type  (default=`19')",
  "      --coaport=INT             Radius disconnect port to listen to  \n                                  (default=`0')",
  "      --coanoipcheck            Allow radius disconnect from any IP  \n                                  (default=off)",
  "      --proxylisten=STRING      IP address to listen to",
  "      --proxyport=INT           UDP port to listen to  (default=`0')",
  "      --proxyclient=STRING      IP address of proxy client(s)",
  "      --proxysecret=STRING      Radius proxy shared secret",
  "      --dhcpif=STRING           Local Ethernet interface",
  "      --dhcpmac=STRING          Interface MAC address",
  "      --lease=INT               Lease time to allocate to clients  \n                                  (default=`600')",
  "      --eapolenable             Enable IEEE 802.1x authentication  \n                                  (default=off)",
  "      --uamserver=STRING        URL of authentication web server",
  "      --uamhomepage=STRING      URL of homepage to redirect unauthenticated \n                                  users to",
  "      --uamsecret=STRING        Shared secret between uamserver and chilli",
  "      --uamlisten=STRING        IP address to listen to for authentication \n                                  requests",
  "      --uamport=INT             TCP port to bind to for authentication requests \n                                   (default=`3990')",
  "      --uamuiport=INT           TCP port to bind to for UAM UI requests  \n                                  (default=`3991')",
  "      --uamallowed=STRING       Domain names exempt from access check ",
  "      --uamanydns               Allow client to use any DNS server  \n                                  (default=off)",
  "      --uamanyip                Allow client to use any IP Address  \n                                  (default=off)",
  "      --nouamsuccess            Do not return to the UAM server on success, \n                                  original url instead  (default=off)",
  "      --nouamwispr              Do not send WISPr XML from ChilliSpot, assume \n                                  back-end does  (default=off)",
  "      --uamlogoutip=STRING      HTTP Auto-Logout IP Address  \n                                  (default=`1.1.1.1')",
  "      --macauth                 Authenticate based on MAC address  \n                                  (default=off)",
  "      --macallowed=STRING       List of allowed MAC addresses",
  "      --macsuffix=STRING        Suffix to add to the MAC address",
  "      --macpasswd=STRING        Password used when performing MAC \n                                  authentication",
  "      --macallowlocal           Do not use RADIUS for authenticating the \n                                  macallowed  (default=off)",
  "      --wwwdir=STRING           Local content served by chilli (for splash \n                                  page, etc)",
  "      --wwwbin=STRING           Script binary (such as haserl) for simple web \n                                  programming",
  "      --uamui=STRING            Program in inetd style to handle all uam \n                                  requests",
  "      --adminuser=STRING        RADIUS administrative user login username",
  "      --adminpasswd=STRING      RADIUS administrative user login password",
  "      --nasmac=STRING           Unique MAC address of the NAS \n                                  (called-station-id)",
  "      --nasip=STRING            Unique IP address of the NAS (nas-ip-address)",
  "      --ssid=STRING             SSID of the session",
  "      --vlan=STRING             VLAN of the session",
  "      --cmdsocket=STRING        path to the command unix socket",
  "      --swapoctets              Swap the meaning of input/output octets/packets \n                                   (default=off)",
  "      --usestatusfile           Use the status file to keep track of sessions  \n                                  (default=off)",
  "      --localusers=STRING       File keep 'Local' usernames and passwords",
  "      --postauthproxy=STRING    IP of an upstream transparent proxy",
  "      --postauthproxyport=INT   Port of an upstream transparent proxy  \n                                  (default=`0')",
  "      --wpaguests               Allow WPA 'Guest' access  (default=off)",
  "      --papalwaysok             Always allow 'PAP' (password) style \n                                  authentication (not advised)  (default=off)",
  "      --chillixml               Use ChilliSpot XML in WISPr blocks  \n                                  (default=off)",
  "      --usetap                  Use a TAP instead of TUN (linux only)  \n                                  (default=off)",
    0
};

static
void clear_given (struct gengetopt_args_info *args_info);
static
void clear_args (struct gengetopt_args_info *args_info);

static int
cmdline_parser_internal (int argc, char * const *argv, struct gengetopt_args_info *args_info, int override, int initialize, int check_required, const char *additional_error);

static int
cmdline_parser_required2 (struct gengetopt_args_info *args_info, const char *prog_name, const char *additional_error);
struct line_list
{
  char * string_arg;
  struct line_list * next;
};

static struct line_list *cmd_line_list = 0;
static struct line_list *cmd_line_list_tmp = 0;

static void
free_cmd_list(void)
{
  /* free the list of a previous call */
  if (cmd_line_list)
    {
      while (cmd_line_list) {
        cmd_line_list_tmp = cmd_line_list;
        cmd_line_list = cmd_line_list->next;
        free (cmd_line_list_tmp->string_arg);
        free (cmd_line_list_tmp);
      }
    }
}


struct string_list
{
  char * arg;
  char *orig;
  struct string_list * next;
};

static char *
gengetopt_strdup (const char *s);

static
void clear_given (struct gengetopt_args_info *args_info)
{
  args_info->help_given = 0 ;
  args_info->version_given = 0 ;
  args_info->fg_given = 0 ;
  args_info->debug_given = 0 ;
  args_info->debugfacility_given = 0 ;
  args_info->logfacility_given = 0 ;
  args_info->conf_given = 0 ;
  args_info->interval_given = 0 ;
  args_info->pidfile_given = 0 ;
  args_info->statedir_given = 0 ;
  args_info->net_given = 0 ;
  args_info->dhcpstart_given = 0 ;
  args_info->dhcpend_given = 0 ;
  args_info->dynip_given = 0 ;
  args_info->statip_given = 0 ;
  args_info->dns1_given = 0 ;
  args_info->dns2_given = 0 ;
  args_info->domain_given = 0 ;
  args_info->ipup_given = 0 ;
  args_info->ipdown_given = 0 ;
  args_info->conup_given = 0 ;
  args_info->condown_given = 0 ;
  args_info->txqlen_given = 0 ;
  args_info->radiuslisten_given = 0 ;
  args_info->radiusserver1_given = 0 ;
  args_info->radiusserver2_given = 0 ;
  args_info->radiusauthport_given = 0 ;
  args_info->radiusacctport_given = 0 ;
  args_info->radiussecret_given = 0 ;
  args_info->radiusnasid_given = 0 ;
  args_info->radiuslocationid_given = 0 ;
  args_info->radiuslocationname_given = 0 ;
  args_info->radiusnasporttype_given = 0 ;
  args_info->coaport_given = 0 ;
  args_info->coanoipcheck_given = 0 ;
  args_info->proxylisten_given = 0 ;
  args_info->proxyport_given = 0 ;
  args_info->proxyclient_given = 0 ;
  args_info->proxysecret_given = 0 ;
  args_info->dhcpif_given = 0 ;
  args_info->dhcpmac_given = 0 ;
  args_info->lease_given = 0 ;
  args_info->eapolenable_given = 0 ;
  args_info->uamserver_given = 0 ;
  args_info->uamhomepage_given = 0 ;
  args_info->uamsecret_given = 0 ;
  args_info->uamlisten_given = 0 ;
  args_info->uamport_given = 0 ;
  args_info->uamuiport_given = 0 ;
  args_info->uamallowed_given = 0 ;
  args_info->uamanydns_given = 0 ;
  args_info->uamanyip_given = 0 ;
  args_info->nouamsuccess_given = 0 ;
  args_info->nouamwispr_given = 0 ;
  args_info->uamlogoutip_given = 0 ;
  args_info->macauth_given = 0 ;
  args_info->macallowed_given = 0 ;
  args_info->macsuffix_given = 0 ;
  args_info->macpasswd_given = 0 ;
  args_info->macallowlocal_given = 0 ;
  args_info->wwwdir_given = 0 ;
  args_info->wwwbin_given = 0 ;
  args_info->uamui_given = 0 ;
  args_info->adminuser_given = 0 ;
  args_info->adminpasswd_given = 0 ;
  args_info->nasmac_given = 0 ;
  args_info->nasip_given = 0 ;
  args_info->ssid_given = 0 ;
  args_info->vlan_given = 0 ;
  args_info->cmdsocket_given = 0 ;
  args_info->swapoctets_given = 0 ;
  args_info->usestatusfile_given = 0 ;
  args_info->localusers_given = 0 ;
  args_info->postauthproxy_given = 0 ;
  args_info->postauthproxyport_given = 0 ;
  args_info->wpaguests_given = 0 ;
  args_info->papalwaysok_given = 0 ;
  args_info->chillixml_given = 0 ;
  args_info->usetap_given = 0 ;
}

static
void clear_args (struct gengetopt_args_info *args_info)
{
  args_info->fg_flag = 0;
  args_info->debug_flag = 0;
  args_info->debugfacility_arg = 1;
  args_info->debugfacility_orig = NULL;
  args_info->logfacility_arg = -1;
  args_info->logfacility_orig = NULL;
  args_info->conf_arg = gengetopt_strdup ("/etc/chilli.conf");
  args_info->conf_orig = NULL;
  args_info->interval_arg = 3600;
  args_info->interval_orig = NULL;
  args_info->pidfile_arg = gengetopt_strdup ("/var/run/chilli.pid");
  args_info->pidfile_orig = NULL;
  args_info->statedir_arg = gengetopt_strdup ("/var/lib/chilli/");
  args_info->statedir_orig = NULL;
  args_info->net_arg = gengetopt_strdup ("192.168.182.0/24");
  args_info->net_orig = NULL;
  args_info->dhcpstart_arg = 10;
  args_info->dhcpstart_orig = NULL;
  args_info->dhcpend_arg = 254;
  args_info->dhcpend_orig = NULL;
  args_info->dynip_arg = NULL;
  args_info->dynip_orig = NULL;
  args_info->statip_arg = NULL;
  args_info->statip_orig = NULL;
  args_info->dns1_arg = NULL;
  args_info->dns1_orig = NULL;
  args_info->dns2_arg = NULL;
  args_info->dns2_orig = NULL;
  args_info->domain_arg = gengetopt_strdup ("coova.org");
  args_info->domain_orig = NULL;
  args_info->ipup_arg = NULL;
  args_info->ipup_orig = NULL;
  args_info->ipdown_arg = NULL;
  args_info->ipdown_orig = NULL;
  args_info->conup_arg = NULL;
  args_info->conup_orig = NULL;
  args_info->condown_arg = NULL;
  args_info->condown_orig = NULL;
  args_info->txqlen_arg = 100;
  args_info->txqlen_orig = NULL;
  args_info->radiuslisten_arg = NULL;
  args_info->radiuslisten_orig = NULL;
  args_info->radiusserver1_arg = NULL;
  args_info->radiusserver1_orig = NULL;
  args_info->radiusserver2_arg = NULL;
  args_info->radiusserver2_orig = NULL;
  args_info->radiusauthport_arg = 1812;
  args_info->radiusauthport_orig = NULL;
  args_info->radiusacctport_arg = 1813;
  args_info->radiusacctport_orig = NULL;
  args_info->radiussecret_arg = NULL;
  args_info->radiussecret_orig = NULL;
  args_info->radiusnasid_arg = gengetopt_strdup ("nas01");
  args_info->radiusnasid_orig = NULL;
  args_info->radiuslocationid_arg = NULL;
  args_info->radiuslocationid_orig = NULL;
  args_info->radiuslocationname_arg = NULL;
  args_info->radiuslocationname_orig = NULL;
  args_info->radiusnasporttype_arg = 19;
  args_info->radiusnasporttype_orig = NULL;
  args_info->coaport_arg = 0;
  args_info->coaport_orig = NULL;
  args_info->coanoipcheck_flag = 0;
  args_info->proxylisten_arg = NULL;
  args_info->proxylisten_orig = NULL;
  args_info->proxyport_arg = 0;
  args_info->proxyport_orig = NULL;
  args_info->proxyclient_arg = NULL;
  args_info->proxyclient_orig = NULL;
  args_info->proxysecret_arg = NULL;
  args_info->proxysecret_orig = NULL;
  args_info->dhcpif_arg = NULL;
  args_info->dhcpif_orig = NULL;
  args_info->dhcpmac_arg = NULL;
  args_info->dhcpmac_orig = NULL;
  args_info->lease_arg = 600;
  args_info->lease_orig = NULL;
  args_info->eapolenable_flag = 0;
  args_info->uamserver_arg = NULL;
  args_info->uamserver_orig = NULL;
  args_info->uamhomepage_arg = NULL;
  args_info->uamhomepage_orig = NULL;
  args_info->uamsecret_arg = NULL;
  args_info->uamsecret_orig = NULL;
  args_info->uamlisten_arg = NULL;
  args_info->uamlisten_orig = NULL;
  args_info->uamport_arg = 3990;
  args_info->uamport_orig = NULL;
  args_info->uamuiport_arg = 3991;
  args_info->uamuiport_orig = NULL;
  args_info->uamallowed_arg = NULL;
  args_info->uamallowed_orig = NULL;
  args_info->uamanydns_flag = 0;
  args_info->uamanyip_flag = 0;
  args_info->nouamsuccess_flag = 0;
  args_info->nouamwispr_flag = 0;
  args_info->uamlogoutip_arg = gengetopt_strdup ("1.1.1.1");
  args_info->uamlogoutip_orig = NULL;
  args_info->macauth_flag = 0;
  args_info->macallowed_arg = NULL;
  args_info->macallowed_orig = NULL;
  args_info->macsuffix_arg = NULL;
  args_info->macsuffix_orig = NULL;
  args_info->macpasswd_arg = NULL;
  args_info->macpasswd_orig = NULL;
  args_info->macallowlocal_flag = 0;
  args_info->wwwdir_arg = NULL;
  args_info->wwwdir_orig = NULL;
  args_info->wwwbin_arg = NULL;
  args_info->wwwbin_orig = NULL;
  args_info->uamui_arg = NULL;
  args_info->uamui_orig = NULL;
  args_info->adminuser_arg = NULL;
  args_info->adminuser_orig = NULL;
  args_info->adminpasswd_arg = NULL;
  args_info->adminpasswd_orig = NULL;
  args_info->nasmac_arg = NULL;
  args_info->nasmac_orig = NULL;
  args_info->nasip_arg = NULL;
  args_info->nasip_orig = NULL;
  args_info->ssid_arg = NULL;
  args_info->ssid_orig = NULL;
  args_info->vlan_arg = NULL;
  args_info->vlan_orig = NULL;
  args_info->cmdsocket_arg = NULL;
  args_info->cmdsocket_orig = NULL;
  args_info->swapoctets_flag = 0;
  args_info->usestatusfile_flag = 0;
  args_info->localusers_arg = NULL;
  args_info->localusers_orig = NULL;
  args_info->postauthproxy_arg = NULL;
  args_info->postauthproxy_orig = NULL;
  args_info->postauthproxyport_arg = 0;
  args_info->postauthproxyport_orig = NULL;
  args_info->wpaguests_flag = 0;
  args_info->papalwaysok_flag = 0;
  args_info->chillixml_flag = 0;
  args_info->usetap_flag = 0;
  
}

static
void init_args_info(struct gengetopt_args_info *args_info)
{
  args_info->help_help = gengetopt_args_info_help[0] ;
  args_info->version_help = gengetopt_args_info_help[1] ;
  args_info->fg_help = gengetopt_args_info_help[2] ;
  args_info->debug_help = gengetopt_args_info_help[3] ;
  args_info->debugfacility_help = gengetopt_args_info_help[4] ;
  args_info->logfacility_help = gengetopt_args_info_help[5] ;
  args_info->conf_help = gengetopt_args_info_help[6] ;
  args_info->interval_help = gengetopt_args_info_help[7] ;
  args_info->pidfile_help = gengetopt_args_info_help[8] ;
  args_info->statedir_help = gengetopt_args_info_help[9] ;
  args_info->net_help = gengetopt_args_info_help[10] ;
  args_info->dhcpstart_help = gengetopt_args_info_help[11] ;
  args_info->dhcpend_help = gengetopt_args_info_help[12] ;
  args_info->dynip_help = gengetopt_args_info_help[13] ;
  args_info->statip_help = gengetopt_args_info_help[14] ;
  args_info->dns1_help = gengetopt_args_info_help[15] ;
  args_info->dns2_help = gengetopt_args_info_help[16] ;
  args_info->domain_help = gengetopt_args_info_help[17] ;
  args_info->ipup_help = gengetopt_args_info_help[18] ;
  args_info->ipdown_help = gengetopt_args_info_help[19] ;
  args_info->conup_help = gengetopt_args_info_help[20] ;
  args_info->condown_help = gengetopt_args_info_help[21] ;
  args_info->txqlen_help = gengetopt_args_info_help[22] ;
  args_info->radiuslisten_help = gengetopt_args_info_help[23] ;
  args_info->radiusserver1_help = gengetopt_args_info_help[24] ;
  args_info->radiusserver2_help = gengetopt_args_info_help[25] ;
  args_info->radiusauthport_help = gengetopt_args_info_help[26] ;
  args_info->radiusacctport_help = gengetopt_args_info_help[27] ;
  args_info->radiussecret_help = gengetopt_args_info_help[28] ;
  args_info->radiusnasid_help = gengetopt_args_info_help[29] ;
  args_info->radiuslocationid_help = gengetopt_args_info_help[30] ;
  args_info->radiuslocationname_help = gengetopt_args_info_help[31] ;
  args_info->radiusnasporttype_help = gengetopt_args_info_help[32] ;
  args_info->coaport_help = gengetopt_args_info_help[33] ;
  args_info->coanoipcheck_help = gengetopt_args_info_help[34] ;
  args_info->proxylisten_help = gengetopt_args_info_help[35] ;
  args_info->proxyport_help = gengetopt_args_info_help[36] ;
  args_info->proxyclient_help = gengetopt_args_info_help[37] ;
  args_info->proxysecret_help = gengetopt_args_info_help[38] ;
  args_info->dhcpif_help = gengetopt_args_info_help[39] ;
  args_info->dhcpmac_help = gengetopt_args_info_help[40] ;
  args_info->lease_help = gengetopt_args_info_help[41] ;
  args_info->eapolenable_help = gengetopt_args_info_help[42] ;
  args_info->uamserver_help = gengetopt_args_info_help[43] ;
  args_info->uamhomepage_help = gengetopt_args_info_help[44] ;
  args_info->uamsecret_help = gengetopt_args_info_help[45] ;
  args_info->uamlisten_help = gengetopt_args_info_help[46] ;
  args_info->uamport_help = gengetopt_args_info_help[47] ;
  args_info->uamuiport_help = gengetopt_args_info_help[48] ;
  args_info->uamallowed_help = gengetopt_args_info_help[49] ;
  args_info->uamallowed_min = -1;
  args_info->uamallowed_max = -1;
  args_info->uamanydns_help = gengetopt_args_info_help[50] ;
  args_info->uamanyip_help = gengetopt_args_info_help[51] ;
  args_info->nouamsuccess_help = gengetopt_args_info_help[52] ;
  args_info->nouamwispr_help = gengetopt_args_info_help[53] ;
  args_info->uamlogoutip_help = gengetopt_args_info_help[54] ;
  args_info->macauth_help = gengetopt_args_info_help[55] ;
  args_info->macallowed_help = gengetopt_args_info_help[56] ;
  args_info->macallowed_min = -1;
  args_info->macallowed_max = -1;
  args_info->macsuffix_help = gengetopt_args_info_help[57] ;
  args_info->macpasswd_help = gengetopt_args_info_help[58] ;
  args_info->macallowlocal_help = gengetopt_args_info_help[59] ;
  args_info->wwwdir_help = gengetopt_args_info_help[60] ;
  args_info->wwwbin_help = gengetopt_args_info_help[61] ;
  args_info->uamui_help = gengetopt_args_info_help[62] ;
  args_info->adminuser_help = gengetopt_args_info_help[63] ;
  args_info->adminpasswd_help = gengetopt_args_info_help[64] ;
  args_info->nasmac_help = gengetopt_args_info_help[65] ;
  args_info->nasip_help = gengetopt_args_info_help[66] ;
  args_info->ssid_help = gengetopt_args_info_help[67] ;
  args_info->vlan_help = gengetopt_args_info_help[68] ;
  args_info->cmdsocket_help = gengetopt_args_info_help[69] ;
  args_info->swapoctets_help = gengetopt_args_info_help[70] ;
  args_info->usestatusfile_help = gengetopt_args_info_help[71] ;
  args_info->localusers_help = gengetopt_args_info_help[72] ;
  args_info->postauthproxy_help = gengetopt_args_info_help[73] ;
  args_info->postauthproxyport_help = gengetopt_args_info_help[74] ;
  args_info->wpaguests_help = gengetopt_args_info_help[75] ;
  args_info->papalwaysok_help = gengetopt_args_info_help[76] ;
  args_info->chillixml_help = gengetopt_args_info_help[77] ;
  args_info->usetap_help = gengetopt_args_info_help[78] ;
  
}

void
cmdline_parser_print_version (void)
{
  printf ("%s %s\n", CMDLINE_PARSER_PACKAGE, CMDLINE_PARSER_VERSION);
}

void
cmdline_parser_print_help (void)
{
  int i = 0;
  cmdline_parser_print_version ();

  if (strlen(gengetopt_args_info_purpose) > 0)
    printf("\n%s\n", gengetopt_args_info_purpose);

  printf("\n%s\n\n", gengetopt_args_info_usage);
  while (gengetopt_args_info_help[i])
    printf("%s\n", gengetopt_args_info_help[i++]);
}

void
cmdline_parser_init (struct gengetopt_args_info *args_info)
{
  clear_given (args_info);
  clear_args (args_info);
  init_args_info (args_info);
}

static void
cmdline_parser_release (struct gengetopt_args_info *args_info)
{
  
  unsigned int i;
  if (args_info->debugfacility_orig)
    {
      free (args_info->debugfacility_orig); /* free previous argument */
      args_info->debugfacility_orig = 0;
    }
  if (args_info->logfacility_orig)
    {
      free (args_info->logfacility_orig); /* free previous argument */
      args_info->logfacility_orig = 0;
    }
  if (args_info->conf_arg)
    {
      free (args_info->conf_arg); /* free previous argument */
      args_info->conf_arg = 0;
    }
  if (args_info->conf_orig)
    {
      free (args_info->conf_orig); /* free previous argument */
      args_info->conf_orig = 0;
    }
  if (args_info->interval_orig)
    {
      free (args_info->interval_orig); /* free previous argument */
      args_info->interval_orig = 0;
    }
  if (args_info->pidfile_arg)
    {
      free (args_info->pidfile_arg); /* free previous argument */
      args_info->pidfile_arg = 0;
    }
  if (args_info->pidfile_orig)
    {
      free (args_info->pidfile_orig); /* free previous argument */
      args_info->pidfile_orig = 0;
    }
  if (args_info->statedir_arg)
    {
      free (args_info->statedir_arg); /* free previous argument */
      args_info->statedir_arg = 0;
    }
  if (args_info->statedir_orig)
    {
      free (args_info->statedir_orig); /* free previous argument */
      args_info->statedir_orig = 0;
    }
  if (args_info->net_arg)
    {
      free (args_info->net_arg); /* free previous argument */
      args_info->net_arg = 0;
    }
  if (args_info->net_orig)
    {
      free (args_info->net_orig); /* free previous argument */
      args_info->net_orig = 0;
    }
  if (args_info->dhcpstart_orig)
    {
      free (args_info->dhcpstart_orig); /* free previous argument */
      args_info->dhcpstart_orig = 0;
    }
  if (args_info->dhcpend_orig)
    {
      free (args_info->dhcpend_orig); /* free previous argument */
      args_info->dhcpend_orig = 0;
    }
  if (args_info->dynip_arg)
    {
      free (args_info->dynip_arg); /* free previous argument */
      args_info->dynip_arg = 0;
    }
  if (args_info->dynip_orig)
    {
      free (args_info->dynip_orig); /* free previous argument */
      args_info->dynip_orig = 0;
    }
  if (args_info->statip_arg)
    {
      free (args_info->statip_arg); /* free previous argument */
      args_info->statip_arg = 0;
    }
  if (args_info->statip_orig)
    {
      free (args_info->statip_orig); /* free previous argument */
      args_info->statip_orig = 0;
    }
  if (args_info->dns1_arg)
    {
      free (args_info->dns1_arg); /* free previous argument */
      args_info->dns1_arg = 0;
    }
  if (args_info->dns1_orig)
    {
      free (args_info->dns1_orig); /* free previous argument */
      args_info->dns1_orig = 0;
    }
  if (args_info->dns2_arg)
    {
      free (args_info->dns2_arg); /* free previous argument */
      args_info->dns2_arg = 0;
    }
  if (args_info->dns2_orig)
    {
      free (args_info->dns2_orig); /* free previous argument */
      args_info->dns2_orig = 0;
    }
  if (args_info->domain_arg)
    {
      free (args_info->domain_arg); /* free previous argument */
      args_info->domain_arg = 0;
    }
  if (args_info->domain_orig)
    {
      free (args_info->domain_orig); /* free previous argument */
      args_info->domain_orig = 0;
    }
  if (args_info->ipup_arg)
    {
      free (args_info->ipup_arg); /* free previous argument */
      args_info->ipup_arg = 0;
    }
  if (args_info->ipup_orig)
    {
      free (args_info->ipup_orig); /* free previous argument */
      args_info->ipup_orig = 0;
    }
  if (args_info->ipdown_arg)
    {
      free (args_info->ipdown_arg); /* free previous argument */
      args_info->ipdown_arg = 0;
    }
  if (args_info->ipdown_orig)
    {
      free (args_info->ipdown_orig); /* free previous argument */
      args_info->ipdown_orig = 0;
    }
  if (args_info->conup_arg)
    {
      free (args_info->conup_arg); /* free previous argument */
      args_info->conup_arg = 0;
    }
  if (args_info->conup_orig)
    {
      free (args_info->conup_orig); /* free previous argument */
      args_info->conup_orig = 0;
    }
  if (args_info->condown_arg)
    {
      free (args_info->condown_arg); /* free previous argument */
      args_info->condown_arg = 0;
    }
  if (args_info->condown_orig)
    {
      free (args_info->condown_orig); /* free previous argument */
      args_info->condown_orig = 0;
    }
  if (args_info->txqlen_orig)
    {
      free (args_info->txqlen_orig); /* free previous argument */
      args_info->txqlen_orig = 0;
    }
  if (args_info->radiuslisten_arg)
    {
      free (args_info->radiuslisten_arg); /* free previous argument */
      args_info->radiuslisten_arg = 0;
    }
  if (args_info->radiuslisten_orig)
    {
      free (args_info->radiuslisten_orig); /* free previous argument */
      args_info->radiuslisten_orig = 0;
    }
  if (args_info->radiusserver1_arg)
    {
      free (args_info->radiusserver1_arg); /* free previous argument */
      args_info->radiusserver1_arg = 0;
    }
  if (args_info->radiusserver1_orig)
    {
      free (args_info->radiusserver1_orig); /* free previous argument */
      args_info->radiusserver1_orig = 0;
    }
  if (args_info->radiusserver2_arg)
    {
      free (args_info->radiusserver2_arg); /* free previous argument */
      args_info->radiusserver2_arg = 0;
    }
  if (args_info->radiusserver2_orig)
    {
      free (args_info->radiusserver2_orig); /* free previous argument */
      args_info->radiusserver2_orig = 0;
    }
  if (args_info->radiusauthport_orig)
    {
      free (args_info->radiusauthport_orig); /* free previous argument */
      args_info->radiusauthport_orig = 0;
    }
  if (args_info->radiusacctport_orig)
    {
      free (args_info->radiusacctport_orig); /* free previous argument */
      args_info->radiusacctport_orig = 0;
    }
  if (args_info->radiussecret_arg)
    {
      free (args_info->radiussecret_arg); /* free previous argument */
      args_info->radiussecret_arg = 0;
    }
  if (args_info->radiussecret_orig)
    {
      free (args_info->radiussecret_orig); /* free previous argument */
      args_info->radiussecret_orig = 0;
    }
  if (args_info->radiusnasid_arg)
    {
      free (args_info->radiusnasid_arg); /* free previous argument */
      args_info->radiusnasid_arg = 0;
    }
  if (args_info->radiusnasid_orig)
    {
      free (args_info->radiusnasid_orig); /* free previous argument */
      args_info->radiusnasid_orig = 0;
    }
  if (args_info->radiuslocationid_arg)
    {
      free (args_info->radiuslocationid_arg); /* free previous argument */
      args_info->radiuslocationid_arg = 0;
    }
  if (args_info->radiuslocationid_orig)
    {
      free (args_info->radiuslocationid_orig); /* free previous argument */
      args_info->radiuslocationid_orig = 0;
    }
  if (args_info->radiuslocationname_arg)
    {
      free (args_info->radiuslocationname_arg); /* free previous argument */
      args_info->radiuslocationname_arg = 0;
    }
  if (args_info->radiuslocationname_orig)
    {
      free (args_info->radiuslocationname_orig); /* free previous argument */
      args_info->radiuslocationname_orig = 0;
    }
  if (args_info->radiusnasporttype_orig)
    {
      free (args_info->radiusnasporttype_orig); /* free previous argument */
      args_info->radiusnasporttype_orig = 0;
    }
  if (args_info->coaport_orig)
    {
      free (args_info->coaport_orig); /* free previous argument */
      args_info->coaport_orig = 0;
    }
  if (args_info->proxylisten_arg)
    {
      free (args_info->proxylisten_arg); /* free previous argument */
      args_info->proxylisten_arg = 0;
    }
  if (args_info->proxylisten_orig)
    {
      free (args_info->proxylisten_orig); /* free previous argument */
      args_info->proxylisten_orig = 0;
    }
  if (args_info->proxyport_orig)
    {
      free (args_info->proxyport_orig); /* free previous argument */
      args_info->proxyport_orig = 0;
    }
  if (args_info->proxyclient_arg)
    {
      free (args_info->proxyclient_arg); /* free previous argument */
      args_info->proxyclient_arg = 0;
    }
  if (args_info->proxyclient_orig)
    {
      free (args_info->proxyclient_orig); /* free previous argument */
      args_info->proxyclient_orig = 0;
    }
  if (args_info->proxysecret_arg)
    {
      free (args_info->proxysecret_arg); /* free previous argument */
      args_info->proxysecret_arg = 0;
    }
  if (args_info->proxysecret_orig)
    {
      free (args_info->proxysecret_orig); /* free previous argument */
      args_info->proxysecret_orig = 0;
    }
  if (args_info->dhcpif_arg)
    {
      free (args_info->dhcpif_arg); /* free previous argument */
      args_info->dhcpif_arg = 0;
    }
  if (args_info->dhcpif_orig)
    {
      free (args_info->dhcpif_orig); /* free previous argument */
      args_info->dhcpif_orig = 0;
    }
  if (args_info->dhcpmac_arg)
    {
      free (args_info->dhcpmac_arg); /* free previous argument */
      args_info->dhcpmac_arg = 0;
    }
  if (args_info->dhcpmac_orig)
    {
      free (args_info->dhcpmac_orig); /* free previous argument */
      args_info->dhcpmac_orig = 0;
    }
  if (args_info->lease_orig)
    {
      free (args_info->lease_orig); /* free previous argument */
      args_info->lease_orig = 0;
    }
  if (args_info->uamserver_arg)
    {
      free (args_info->uamserver_arg); /* free previous argument */
      args_info->uamserver_arg = 0;
    }
  if (args_info->uamserver_orig)
    {
      free (args_info->uamserver_orig); /* free previous argument */
      args_info->uamserver_orig = 0;
    }
  if (args_info->uamhomepage_arg)
    {
      free (args_info->uamhomepage_arg); /* free previous argument */
      args_info->uamhomepage_arg = 0;
    }
  if (args_info->uamhomepage_orig)
    {
      free (args_info->uamhomepage_orig); /* free previous argument */
      args_info->uamhomepage_orig = 0;
    }
  if (args_info->uamsecret_arg)
    {
      free (args_info->uamsecret_arg); /* free previous argument */
      args_info->uamsecret_arg = 0;
    }
  if (args_info->uamsecret_orig)
    {
      free (args_info->uamsecret_orig); /* free previous argument */
      args_info->uamsecret_orig = 0;
    }
  if (args_info->uamlisten_arg)
    {
      free (args_info->uamlisten_arg); /* free previous argument */
      args_info->uamlisten_arg = 0;
    }
  if (args_info->uamlisten_orig)
    {
      free (args_info->uamlisten_orig); /* free previous argument */
      args_info->uamlisten_orig = 0;
    }
  if (args_info->uamport_orig)
    {
      free (args_info->uamport_orig); /* free previous argument */
      args_info->uamport_orig = 0;
    }
  if (args_info->uamuiport_orig)
    {
      free (args_info->uamuiport_orig); /* free previous argument */
      args_info->uamuiport_orig = 0;
    }
  if (args_info->uamallowed_arg)
    {
      for (i = 0; i < args_info->uamallowed_given; ++i)
        {
          if (args_info->uamallowed_arg [i])
            {
              free (args_info->uamallowed_arg [i]); /* free previous argument */
              args_info->uamallowed_arg [i] = 0;
            }
          if (args_info->uamallowed_orig [i])
            {
              free (args_info->uamallowed_orig [i]); /* free previous argument */
              args_info->uamallowed_orig [i] = 0;
            }
        }
      if (args_info->uamallowed_arg [0])
        free (args_info->uamallowed_arg [0]); /* free default string */
      free (args_info->uamallowed_arg); /* free previous argument */
      args_info->uamallowed_arg = 0;
      free (args_info->uamallowed_orig); /* free previous argument */
      args_info->uamallowed_orig = 0;
    }
  if (args_info->uamlogoutip_arg)
    {
      free (args_info->uamlogoutip_arg); /* free previous argument */
      args_info->uamlogoutip_arg = 0;
    }
  if (args_info->uamlogoutip_orig)
    {
      free (args_info->uamlogoutip_orig); /* free previous argument */
      args_info->uamlogoutip_orig = 0;
    }
  if (args_info->macallowed_arg)
    {
      for (i = 0; i < args_info->macallowed_given; ++i)
        {
          if (args_info->macallowed_arg [i])
            {
              free (args_info->macallowed_arg [i]); /* free previous argument */
              args_info->macallowed_arg [i] = 0;
            }
          if (args_info->macallowed_orig [i])
            {
              free (args_info->macallowed_orig [i]); /* free previous argument */
              args_info->macallowed_orig [i] = 0;
            }
        }
      if (args_info->macallowed_arg [0])
        free (args_info->macallowed_arg [0]); /* free default string */
      free (args_info->macallowed_arg); /* free previous argument */
      args_info->macallowed_arg = 0;
      free (args_info->macallowed_orig); /* free previous argument */
      args_info->macallowed_orig = 0;
    }
  if (args_info->macsuffix_arg)
    {
      free (args_info->macsuffix_arg); /* free previous argument */
      args_info->macsuffix_arg = 0;
    }
  if (args_info->macsuffix_orig)
    {
      free (args_info->macsuffix_orig); /* free previous argument */
      args_info->macsuffix_orig = 0;
    }
  if (args_info->macpasswd_arg)
    {
      free (args_info->macpasswd_arg); /* free previous argument */
      args_info->macpasswd_arg = 0;
    }
  if (args_info->macpasswd_orig)
    {
      free (args_info->macpasswd_orig); /* free previous argument */
      args_info->macpasswd_orig = 0;
    }
  if (args_info->wwwdir_arg)
    {
      free (args_info->wwwdir_arg); /* free previous argument */
      args_info->wwwdir_arg = 0;
    }
  if (args_info->wwwdir_orig)
    {
      free (args_info->wwwdir_orig); /* free previous argument */
      args_info->wwwdir_orig = 0;
    }
  if (args_info->wwwbin_arg)
    {
      free (args_info->wwwbin_arg); /* free previous argument */
      args_info->wwwbin_arg = 0;
    }
  if (args_info->wwwbin_orig)
    {
      free (args_info->wwwbin_orig); /* free previous argument */
      args_info->wwwbin_orig = 0;
    }
  if (args_info->uamui_arg)
    {
      free (args_info->uamui_arg); /* free previous argument */
      args_info->uamui_arg = 0;
    }
  if (args_info->uamui_orig)
    {
      free (args_info->uamui_orig); /* free previous argument */
      args_info->uamui_orig = 0;
    }
  if (args_info->adminuser_arg)
    {
      free (args_info->adminuser_arg); /* free previous argument */
      args_info->adminuser_arg = 0;
    }
  if (args_info->adminuser_orig)
    {
      free (args_info->adminuser_orig); /* free previous argument */
      args_info->adminuser_orig = 0;
    }
  if (args_info->adminpasswd_arg)
    {
      free (args_info->adminpasswd_arg); /* free previous argument */
      args_info->adminpasswd_arg = 0;
    }
  if (args_info->adminpasswd_orig)
    {
      free (args_info->adminpasswd_orig); /* free previous argument */
      args_info->adminpasswd_orig = 0;
    }
  if (args_info->nasmac_arg)
    {
      free (args_info->nasmac_arg); /* free previous argument */
      args_info->nasmac_arg = 0;
    }
  if (args_info->nasmac_orig)
    {
      free (args_info->nasmac_orig); /* free previous argument */
      args_info->nasmac_orig = 0;
    }
  if (args_info->nasip_arg)
    {
      free (args_info->nasip_arg); /* free previous argument */
      args_info->nasip_arg = 0;
    }
  if (args_info->nasip_orig)
    {
      free (args_info->nasip_orig); /* free previous argument */
      args_info->nasip_orig = 0;
    }
  if (args_info->ssid_arg)
    {
      free (args_info->ssid_arg); /* free previous argument */
      args_info->ssid_arg = 0;
    }
  if (args_info->ssid_orig)
    {
      free (args_info->ssid_orig); /* free previous argument */
      args_info->ssid_orig = 0;
    }
  if (args_info->vlan_arg)
    {
      free (args_info->vlan_arg); /* free previous argument */
      args_info->vlan_arg = 0;
    }
  if (args_info->vlan_orig)
    {
      free (args_info->vlan_orig); /* free previous argument */
      args_info->vlan_orig = 0;
    }
  if (args_info->cmdsocket_arg)
    {
      free (args_info->cmdsocket_arg); /* free previous argument */
      args_info->cmdsocket_arg = 0;
    }
  if (args_info->cmdsocket_orig)
    {
      free (args_info->cmdsocket_orig); /* free previous argument */
      args_info->cmdsocket_orig = 0;
    }
  if (args_info->localusers_arg)
    {
      free (args_info->localusers_arg); /* free previous argument */
      args_info->localusers_arg = 0;
    }
  if (args_info->localusers_orig)
    {
      free (args_info->localusers_orig); /* free previous argument */
      args_info->localusers_orig = 0;
    }
  if (args_info->postauthproxy_arg)
    {
      free (args_info->postauthproxy_arg); /* free previous argument */
      args_info->postauthproxy_arg = 0;
    }
  if (args_info->postauthproxy_orig)
    {
      free (args_info->postauthproxy_orig); /* free previous argument */
      args_info->postauthproxy_orig = 0;
    }
  if (args_info->postauthproxyport_orig)
    {
      free (args_info->postauthproxyport_orig); /* free previous argument */
      args_info->postauthproxyport_orig = 0;
    }
  
  clear_given (args_info);
}

int
cmdline_parser_file_save(const char *filename, struct gengetopt_args_info *args_info)
{
  FILE *outfile;
  int i = 0;

  outfile = fopen(filename, "w");

  if (!outfile)
    {
      fprintf (stderr, "%s: cannot open file for writing: %s\n", CMDLINE_PARSER_PACKAGE, filename);
      return EXIT_FAILURE;
    }

  if (args_info->help_given) {
    fprintf(outfile, "%s\n", "help");
  }
  if (args_info->version_given) {
    fprintf(outfile, "%s\n", "version");
  }
  if (args_info->fg_given) {
    fprintf(outfile, "%s\n", "fg");
  }
  if (args_info->debug_given) {
    fprintf(outfile, "%s\n", "debug");
  }
  if (args_info->debugfacility_given) {
    if (args_info->debugfacility_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "debugfacility", args_info->debugfacility_orig);
    } else {
      fprintf(outfile, "%s\n", "debugfacility");
    }
  }
  if (args_info->logfacility_given) {
    if (args_info->logfacility_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "logfacility", args_info->logfacility_orig);
    } else {
      fprintf(outfile, "%s\n", "logfacility");
    }
  }
  if (args_info->conf_given) {
    if (args_info->conf_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "conf", args_info->conf_orig);
    } else {
      fprintf(outfile, "%s\n", "conf");
    }
  }
  if (args_info->interval_given) {
    if (args_info->interval_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "interval", args_info->interval_orig);
    } else {
      fprintf(outfile, "%s\n", "interval");
    }
  }
  if (args_info->pidfile_given) {
    if (args_info->pidfile_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "pidfile", args_info->pidfile_orig);
    } else {
      fprintf(outfile, "%s\n", "pidfile");
    }
  }
  if (args_info->statedir_given) {
    if (args_info->statedir_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "statedir", args_info->statedir_orig);
    } else {
      fprintf(outfile, "%s\n", "statedir");
    }
  }
  if (args_info->net_given) {
    if (args_info->net_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "net", args_info->net_orig);
    } else {
      fprintf(outfile, "%s\n", "net");
    }
  }
  if (args_info->dhcpstart_given) {
    if (args_info->dhcpstart_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "dhcpstart", args_info->dhcpstart_orig);
    } else {
      fprintf(outfile, "%s\n", "dhcpstart");
    }
  }
  if (args_info->dhcpend_given) {
    if (args_info->dhcpend_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "dhcpend", args_info->dhcpend_orig);
    } else {
      fprintf(outfile, "%s\n", "dhcpend");
    }
  }
  if (args_info->dynip_given) {
    if (args_info->dynip_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "dynip", args_info->dynip_orig);
    } else {
      fprintf(outfile, "%s\n", "dynip");
    }
  }
  if (args_info->statip_given) {
    if (args_info->statip_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "statip", args_info->statip_orig);
    } else {
      fprintf(outfile, "%s\n", "statip");
    }
  }
  if (args_info->dns1_given) {
    if (args_info->dns1_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "dns1", args_info->dns1_orig);
    } else {
      fprintf(outfile, "%s\n", "dns1");
    }
  }
  if (args_info->dns2_given) {
    if (args_info->dns2_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "dns2", args_info->dns2_orig);
    } else {
      fprintf(outfile, "%s\n", "dns2");
    }
  }
  if (args_info->domain_given) {
    if (args_info->domain_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "domain", args_info->domain_orig);
    } else {
      fprintf(outfile, "%s\n", "domain");
    }
  }
  if (args_info->ipup_given) {
    if (args_info->ipup_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "ipup", args_info->ipup_orig);
    } else {
      fprintf(outfile, "%s\n", "ipup");
    }
  }
  if (args_info->ipdown_given) {
    if (args_info->ipdown_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "ipdown", args_info->ipdown_orig);
    } else {
      fprintf(outfile, "%s\n", "ipdown");
    }
  }
  if (args_info->conup_given) {
    if (args_info->conup_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "conup", args_info->conup_orig);
    } else {
      fprintf(outfile, "%s\n", "conup");
    }
  }
  if (args_info->condown_given) {
    if (args_info->condown_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "condown", args_info->condown_orig);
    } else {
      fprintf(outfile, "%s\n", "condown");
    }
  }
  if (args_info->txqlen_given) {
    if (args_info->txqlen_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "txqlen", args_info->txqlen_orig);
    } else {
      fprintf(outfile, "%s\n", "txqlen");
    }
  }
  if (args_info->radiuslisten_given) {
    if (args_info->radiuslisten_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "radiuslisten", args_info->radiuslisten_orig);
    } else {
      fprintf(outfile, "%s\n", "radiuslisten");
    }
  }
  if (args_info->radiusserver1_given) {
    if (args_info->radiusserver1_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "radiusserver1", args_info->radiusserver1_orig);
    } else {
      fprintf(outfile, "%s\n", "radiusserver1");
    }
  }
  if (args_info->radiusserver2_given) {
    if (args_info->radiusserver2_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "radiusserver2", args_info->radiusserver2_orig);
    } else {
      fprintf(outfile, "%s\n", "radiusserver2");
    }
  }
  if (args_info->radiusauthport_given) {
    if (args_info->radiusauthport_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "radiusauthport", args_info->radiusauthport_orig);
    } else {
      fprintf(outfile, "%s\n", "radiusauthport");
    }
  }
  if (args_info->radiusacctport_given) {
    if (args_info->radiusacctport_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "radiusacctport", args_info->radiusacctport_orig);
    } else {
      fprintf(outfile, "%s\n", "radiusacctport");
    }
  }
  if (args_info->radiussecret_given) {
    if (args_info->radiussecret_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "radiussecret", args_info->radiussecret_orig);
    } else {
      fprintf(outfile, "%s\n", "radiussecret");
    }
  }
  if (args_info->radiusnasid_given) {
    if (args_info->radiusnasid_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "radiusnasid", args_info->radiusnasid_orig);
    } else {
      fprintf(outfile, "%s\n", "radiusnasid");
    }
  }
  if (args_info->radiuslocationid_given) {
    if (args_info->radiuslocationid_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "radiuslocationid", args_info->radiuslocationid_orig);
    } else {
      fprintf(outfile, "%s\n", "radiuslocationid");
    }
  }
  if (args_info->radiuslocationname_given) {
    if (args_info->radiuslocationname_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "radiuslocationname", args_info->radiuslocationname_orig);
    } else {
      fprintf(outfile, "%s\n", "radiuslocationname");
    }
  }
  if (args_info->radiusnasporttype_given) {
    if (args_info->radiusnasporttype_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "radiusnasporttype", args_info->radiusnasporttype_orig);
    } else {
      fprintf(outfile, "%s\n", "radiusnasporttype");
    }
  }
  if (args_info->coaport_given) {
    if (args_info->coaport_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "coaport", args_info->coaport_orig);
    } else {
      fprintf(outfile, "%s\n", "coaport");
    }
  }
  if (args_info->coanoipcheck_given) {
    fprintf(outfile, "%s\n", "coanoipcheck");
  }
  if (args_info->proxylisten_given) {
    if (args_info->proxylisten_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "proxylisten", args_info->proxylisten_orig);
    } else {
      fprintf(outfile, "%s\n", "proxylisten");
    }
  }
  if (args_info->proxyport_given) {
    if (args_info->proxyport_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "proxyport", args_info->proxyport_orig);
    } else {
      fprintf(outfile, "%s\n", "proxyport");
    }
  }
  if (args_info->proxyclient_given) {
    if (args_info->proxyclient_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "proxyclient", args_info->proxyclient_orig);
    } else {
      fprintf(outfile, "%s\n", "proxyclient");
    }
  }
  if (args_info->proxysecret_given) {
    if (args_info->proxysecret_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "proxysecret", args_info->proxysecret_orig);
    } else {
      fprintf(outfile, "%s\n", "proxysecret");
    }
  }
  if (args_info->dhcpif_given) {
    if (args_info->dhcpif_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "dhcpif", args_info->dhcpif_orig);
    } else {
      fprintf(outfile, "%s\n", "dhcpif");
    }
  }
  if (args_info->dhcpmac_given) {
    if (args_info->dhcpmac_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "dhcpmac", args_info->dhcpmac_orig);
    } else {
      fprintf(outfile, "%s\n", "dhcpmac");
    }
  }
  if (args_info->lease_given) {
    if (args_info->lease_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "lease", args_info->lease_orig);
    } else {
      fprintf(outfile, "%s\n", "lease");
    }
  }
  if (args_info->eapolenable_given) {
    fprintf(outfile, "%s\n", "eapolenable");
  }
  if (args_info->uamserver_given) {
    if (args_info->uamserver_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "uamserver", args_info->uamserver_orig);
    } else {
      fprintf(outfile, "%s\n", "uamserver");
    }
  }
  if (args_info->uamhomepage_given) {
    if (args_info->uamhomepage_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "uamhomepage", args_info->uamhomepage_orig);
    } else {
      fprintf(outfile, "%s\n", "uamhomepage");
    }
  }
  if (args_info->uamsecret_given) {
    if (args_info->uamsecret_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "uamsecret", args_info->uamsecret_orig);
    } else {
      fprintf(outfile, "%s\n", "uamsecret");
    }
  }
  if (args_info->uamlisten_given) {
    if (args_info->uamlisten_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "uamlisten", args_info->uamlisten_orig);
    } else {
      fprintf(outfile, "%s\n", "uamlisten");
    }
  }
  if (args_info->uamport_given) {
    if (args_info->uamport_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "uamport", args_info->uamport_orig);
    } else {
      fprintf(outfile, "%s\n", "uamport");
    }
  }
  if (args_info->uamuiport_given) {
    if (args_info->uamuiport_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "uamuiport", args_info->uamuiport_orig);
    } else {
      fprintf(outfile, "%s\n", "uamuiport");
    }
  }
  if (args_info->uamallowed_orig)
    {
      for (i = 0; i < args_info->uamallowed_given; ++i)
        {
          if (args_info->uamallowed_orig [i])
            {
              fprintf(outfile, "%s=\"%s\"\n", "uamallowed", args_info->uamallowed_orig [i]);
            }
        }
    }
  if (args_info->uamanydns_given) {
    fprintf(outfile, "%s\n", "uamanydns");
  }
  if (args_info->uamanyip_given) {
    fprintf(outfile, "%s\n", "uamanyip");
  }
  if (args_info->nouamsuccess_given) {
    fprintf(outfile, "%s\n", "nouamsuccess");
  }
  if (args_info->nouamwispr_given) {
    fprintf(outfile, "%s\n", "nouamwispr");
  }
  if (args_info->uamlogoutip_given) {
    if (args_info->uamlogoutip_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "uamlogoutip", args_info->uamlogoutip_orig);
    } else {
      fprintf(outfile, "%s\n", "uamlogoutip");
    }
  }
  if (args_info->macauth_given) {
    fprintf(outfile, "%s\n", "macauth");
  }
  if (args_info->macallowed_orig)
    {
      for (i = 0; i < args_info->macallowed_given; ++i)
        {
          if (args_info->macallowed_orig [i])
            {
              fprintf(outfile, "%s=\"%s\"\n", "macallowed", args_info->macallowed_orig [i]);
            }
        }
    }
  if (args_info->macsuffix_given) {
    if (args_info->macsuffix_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "macsuffix", args_info->macsuffix_orig);
    } else {
      fprintf(outfile, "%s\n", "macsuffix");
    }
  }
  if (args_info->macpasswd_given) {
    if (args_info->macpasswd_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "macpasswd", args_info->macpasswd_orig);
    } else {
      fprintf(outfile, "%s\n", "macpasswd");
    }
  }
  if (args_info->macallowlocal_given) {
    fprintf(outfile, "%s\n", "macallowlocal");
  }
  if (args_info->wwwdir_given) {
    if (args_info->wwwdir_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "wwwdir", args_info->wwwdir_orig);
    } else {
      fprintf(outfile, "%s\n", "wwwdir");
    }
  }
  if (args_info->wwwbin_given) {
    if (args_info->wwwbin_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "wwwbin", args_info->wwwbin_orig);
    } else {
      fprintf(outfile, "%s\n", "wwwbin");
    }
  }
  if (args_info->uamui_given) {
    if (args_info->uamui_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "uamui", args_info->uamui_orig);
    } else {
      fprintf(outfile, "%s\n", "uamui");
    }
  }
  if (args_info->adminuser_given) {
    if (args_info->adminuser_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "adminuser", args_info->adminuser_orig);
    } else {
      fprintf(outfile, "%s\n", "adminuser");
    }
  }
  if (args_info->adminpasswd_given) {
    if (args_info->adminpasswd_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "adminpasswd", args_info->adminpasswd_orig);
    } else {
      fprintf(outfile, "%s\n", "adminpasswd");
    }
  }
  if (args_info->nasmac_given) {
    if (args_info->nasmac_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "nasmac", args_info->nasmac_orig);
    } else {
      fprintf(outfile, "%s\n", "nasmac");
    }
  }
  if (args_info->nasip_given) {
    if (args_info->nasip_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "nasip", args_info->nasip_orig);
    } else {
      fprintf(outfile, "%s\n", "nasip");
    }
  }
  if (args_info->ssid_given) {
    if (args_info->ssid_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "ssid", args_info->ssid_orig);
    } else {
      fprintf(outfile, "%s\n", "ssid");
    }
  }
  if (args_info->vlan_given) {
    if (args_info->vlan_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "vlan", args_info->vlan_orig);
    } else {
      fprintf(outfile, "%s\n", "vlan");
    }
  }
  if (args_info->cmdsocket_given) {
    if (args_info->cmdsocket_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "cmdsocket", args_info->cmdsocket_orig);
    } else {
      fprintf(outfile, "%s\n", "cmdsocket");
    }
  }
  if (args_info->swapoctets_given) {
    fprintf(outfile, "%s\n", "swapoctets");
  }
  if (args_info->usestatusfile_given) {
    fprintf(outfile, "%s\n", "usestatusfile");
  }
  if (args_info->localusers_given) {
    if (args_info->localusers_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "localusers", args_info->localusers_orig);
    } else {
      fprintf(outfile, "%s\n", "localusers");
    }
  }
  if (args_info->postauthproxy_given) {
    if (args_info->postauthproxy_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "postauthproxy", args_info->postauthproxy_orig);
    } else {
      fprintf(outfile, "%s\n", "postauthproxy");
    }
  }
  if (args_info->postauthproxyport_given) {
    if (args_info->postauthproxyport_orig) {
      fprintf(outfile, "%s=\"%s\"\n", "postauthproxyport", args_info->postauthproxyport_orig);
    } else {
      fprintf(outfile, "%s\n", "postauthproxyport");
    }
  }
  if (args_info->wpaguests_given) {
    fprintf(outfile, "%s\n", "wpaguests");
  }
  if (args_info->papalwaysok_given) {
    fprintf(outfile, "%s\n", "papalwaysok");
  }
  if (args_info->chillixml_given) {
    fprintf(outfile, "%s\n", "chillixml");
  }
  if (args_info->usetap_given) {
    fprintf(outfile, "%s\n", "usetap");
  }
  
  fclose (outfile);

  i = EXIT_SUCCESS;
  return i;
}

void
cmdline_parser_free (struct gengetopt_args_info *args_info)
{
  cmdline_parser_release (args_info);
}


/* gengetopt_strdup() */
/* strdup.c replacement of strdup, which is not standard */
char *
gengetopt_strdup (const char *s)
{
  char *result = NULL;
  if (!s)
    return result;

  result = (char*)malloc(strlen(s) + 1);
  if (result == (char*)0)
    return (char*)0;
  strcpy(result, s);
  return result;
}

static char *
get_multiple_arg_token(const char *arg)
{
  char *tok, *ret;
  size_t len, num_of_escape;
  int i, j;

  if (!arg)
    return NULL;

  tok = strchr (arg, ',');
  num_of_escape = 0;

  /* make sure it is not escaped */
  while (tok)
    {
      if (*(tok-1) == '\\')
        {
          /* find the next one */
          tok = strchr (tok+1, ',');
          ++num_of_escape;
        }
      else
        break;
    }

  if (tok)
    len = (size_t)(tok - arg + 1);
  else
    len = strlen (arg) + 1;

  len -= num_of_escape;

  ret = (char *) malloc (len);

  i = 0;
  j = 0;
  while (arg[i] && (j < len-1))
    {
      if (arg[i] == '\\')
        ++i;

      ret[j++] = arg[i++];
    }

  ret[len-1] = '\0';

  return ret;
}

static char *
get_multiple_arg_token_next(const char *arg)
{
  char *tok;

  if (!arg)
    return NULL;

  tok = strchr (arg, ',');

  /* make sure it is not escaped */
  while (tok)
    {
      if (*(tok-1) == '\\')
        {
          /* find the next one */
          tok = strchr (tok+1, ',');
        }
      else
        break;
    }

  if (! tok || strlen(tok) == 1)
    return 0;

  return tok+1;
}

static int
check_multiple_option_occurrences(const char *prog_name, unsigned int option_given, int min, int max, const char *option_desc);

int
check_multiple_option_occurrences(const char *prog_name, unsigned int option_given, int min, int max, const char *option_desc)
{
  int error = 0;

  if (option_given && ! (min < 0 && max < 0))
    {
      if (min >= 0 && max >= 0)
        {
          if (min == max)
            {
              /* specific occurrences */
              if (option_given != min)
                {
                  fprintf (stderr, "%s: %s option occurrences must be %d\n",
                    prog_name, option_desc, min);
                  error = 1;
                }
            }
          else if (option_given < min
              || option_given > max)
            {
              /* range occurrences */
              fprintf (stderr, "%s: %s option occurrences must be between %d and %d\n",
                prog_name, option_desc, min, max);
              error = 1;
            }
        }
      else if (min >= 0)
        {
          /* at least check */
          if (option_given < min)
            {
              fprintf (stderr, "%s: %s option occurrences must be at least %d\n",
                prog_name, option_desc, min);
              error = 1;
            }
        }
      else if (max >= 0)
        {
          /* at most check */
          if (option_given > max)
            {
              fprintf (stderr, "%s: %s option occurrences must be at most %d\n",
                prog_name, option_desc, max);
              error = 1;
            }
        }
    }
    
  return error;
}
int
cmdline_parser (int argc, char * const *argv, struct gengetopt_args_info *args_info)
{
  return cmdline_parser2 (argc, argv, args_info, 0, 1, 1);
}

int
cmdline_parser2 (int argc, char * const *argv, struct gengetopt_args_info *args_info, int override, int initialize, int check_required)
{
  int result;

  result = cmdline_parser_internal (argc, argv, args_info, override, initialize, check_required, NULL);

  if (result == EXIT_FAILURE)
    {
      cmdline_parser_free (args_info);
      exit (EXIT_FAILURE);
    }
  
  return result;
}

int
cmdline_parser_required (struct gengetopt_args_info *args_info, const char *prog_name)
{
  int result = EXIT_SUCCESS;

  if (cmdline_parser_required2(args_info, prog_name, NULL) > 0)
    result = EXIT_FAILURE;

  if (result == EXIT_FAILURE)
    {
      cmdline_parser_free (args_info);
      exit (EXIT_FAILURE);
    }
  
  return result;
}

int
cmdline_parser_required2 (struct gengetopt_args_info *args_info, const char *prog_name, const char *additional_error)
{
  int error = 0;

  /* checks for required options */
  if (check_multiple_option_occurrences(prog_name, args_info->uamallowed_given, args_info->uamallowed_min, args_info->uamallowed_max, "'--uamallowed'"))
     error = 1;
  
  if (check_multiple_option_occurrences(prog_name, args_info->macallowed_given, args_info->macallowed_min, args_info->macallowed_max, "'--macallowed'"))
     error = 1;
  
  
  /* checks for dependences among options */

  return error;
}

int
cmdline_parser_internal (int argc, char * const *argv, struct gengetopt_args_info *args_info, int override, int initialize, int check_required, const char *additional_error)
{
  int c;	/* Character of the parsed option.  */
  char *multi_token, *multi_next; /* for multiple options */

  int i;        /* Counter */

  struct string_list * uamallowed_list = NULL,* uamallowed_new = NULL;
  struct string_list * macallowed_list = NULL,* macallowed_new = NULL;
  int error = 0;
  struct gengetopt_args_info local_args_info;

  if (initialize)
    cmdline_parser_init (args_info);

  cmdline_parser_init (&local_args_info);

  optarg = 0;
  optind = 0;
  opterr = 1;
  optopt = '?';

  while (1)
    {
      int option_index = 0;
      char *stop_char;

      static struct option long_options[] = {
        { "help",	0, NULL, 'h' },
        { "version",	0, NULL, 'V' },
        { "fg",	0, NULL, 'f' },
        { "debug",	0, NULL, 'd' },
        { "debugfacility",	1, NULL, 0 },
        { "logfacility",	1, NULL, 0 },
        { "conf",	1, NULL, 'c' },
        { "interval",	1, NULL, 0 },
        { "pidfile",	1, NULL, 0 },
        { "statedir",	1, NULL, 0 },
        { "net",	1, NULL, 'n' },
        { "dhcpstart",	1, NULL, 0 },
        { "dhcpend",	1, NULL, 0 },
        { "dynip",	1, NULL, 0 },
        { "statip",	1, NULL, 0 },
        { "dns1",	1, NULL, 0 },
        { "dns2",	1, NULL, 0 },
        { "domain",	1, NULL, 0 },
        { "ipup",	1, NULL, 0 },
        { "ipdown",	1, NULL, 0 },
        { "conup",	1, NULL, 0 },
        { "condown",	1, NULL, 0 },
        { "txqlen",	1, NULL, 0 },
        { "radiuslisten",	1, NULL, 0 },
        { "radiusserver1",	1, NULL, 0 },
        { "radiusserver2",	1, NULL, 0 },
        { "radiusauthport",	1, NULL, 0 },
        { "radiusacctport",	1, NULL, 0 },
        { "radiussecret",	1, NULL, 0 },
        { "radiusnasid",	1, NULL, 0 },
        { "radiuslocationid",	1, NULL, 0 },
        { "radiuslocationname",	1, NULL, 0 },
        { "radiusnasporttype",	1, NULL, 0 },
        { "coaport",	1, NULL, 0 },
        { "coanoipcheck",	0, NULL, 0 },
        { "proxylisten",	1, NULL, 0 },
        { "proxyport",	1, NULL, 0 },
        { "proxyclient",	1, NULL, 0 },
        { "proxysecret",	1, NULL, 0 },
        { "dhcpif",	1, NULL, 0 },
        { "dhcpmac",	1, NULL, 0 },
        { "lease",	1, NULL, 0 },
        { "eapolenable",	0, NULL, 0 },
        { "uamserver",	1, NULL, 0 },
        { "uamhomepage",	1, NULL, 0 },
        { "uamsecret",	1, NULL, 0 },
        { "uamlisten",	1, NULL, 0 },
        { "uamport",	1, NULL, 0 },
        { "uamuiport",	1, NULL, 0 },
        { "uamallowed",	1, NULL, 0 },
        { "uamanydns",	0, NULL, 0 },
        { "uamanyip",	0, NULL, 0 },
        { "nouamsuccess",	0, NULL, 0 },
        { "nouamwispr",	0, NULL, 0 },
        { "uamlogoutip",	1, NULL, 0 },
        { "macauth",	0, NULL, 0 },
        { "macallowed",	1, NULL, 0 },
        { "macsuffix",	1, NULL, 0 },
        { "macpasswd",	1, NULL, 0 },
        { "macallowlocal",	0, NULL, 0 },
        { "wwwdir",	1, NULL, 0 },
        { "wwwbin",	1, NULL, 0 },
        { "uamui",	1, NULL, 0 },
        { "adminuser",	1, NULL, 0 },
        { "adminpasswd",	1, NULL, 0 },
        { "nasmac",	1, NULL, 0 },
        { "nasip",	1, NULL, 0 },
        { "ssid",	1, NULL, 0 },
        { "vlan",	1, NULL, 0 },
        { "cmdsocket",	1, NULL, 0 },
        { "swapoctets",	0, NULL, 0 },
        { "usestatusfile",	0, NULL, 0 },
        { "localusers",	1, NULL, 0 },
        { "postauthproxy",	1, NULL, 0 },
        { "postauthproxyport",	1, NULL, 0 },
        { "wpaguests",	0, NULL, 0 },
        { "papalwaysok",	0, NULL, 0 },
        { "chillixml",	0, NULL, 0 },
        { "usetap",	0, NULL, 0 },
        { NULL,	0, NULL, 0 }
      };

      stop_char = 0;
      c = getopt_long (argc, argv, "hVfdc:n:", long_options, &option_index);

      if (c == -1) break;	/* Exit from `while (1)' loop.  */

      switch (c)
        {
        case 'h':	/* Print help and exit.  */
          cmdline_parser_print_help ();
          cmdline_parser_free (&local_args_info);
          exit (EXIT_SUCCESS);

        case 'V':	/* Print version and exit.  */
          cmdline_parser_print_version ();
          cmdline_parser_free (&local_args_info);
          exit (EXIT_SUCCESS);

        case 'f':	/* Run in foreground.  */
          if (local_args_info.fg_given)
            {
              fprintf (stderr, "%s: `--fg' (`-f') option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
              goto failure;
            }
          if (args_info->fg_given && ! override)
            continue;
          local_args_info.fg_given = 1;
          args_info->fg_given = 1;
          args_info->fg_flag = !(args_info->fg_flag);
          break;

        case 'd':	/* Run in debug mode.  */
          if (local_args_info.debug_given)
            {
              fprintf (stderr, "%s: `--debug' (`-d') option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
              goto failure;
            }
          if (args_info->debug_given && ! override)
            continue;
          local_args_info.debug_given = 1;
          args_info->debug_given = 1;
          args_info->debug_flag = !(args_info->debug_flag);
          break;

        case 'c':	/* Read configuration file.  */
          if (local_args_info.conf_given)
            {
              fprintf (stderr, "%s: `--conf' (`-c') option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
              goto failure;
            }
          if (args_info->conf_given && ! override)
            continue;
          local_args_info.conf_given = 1;
          args_info->conf_given = 1;
          if (args_info->conf_arg)
            free (args_info->conf_arg); /* free previous string */
          args_info->conf_arg = gengetopt_strdup (optarg);
          if (args_info->conf_orig)
            free (args_info->conf_orig); /* free previous string */
          args_info->conf_orig = gengetopt_strdup (optarg);
          break;

        case 'n':	/* Network.  */
          if (local_args_info.net_given)
            {
              fprintf (stderr, "%s: `--net' (`-n') option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
              goto failure;
            }
          if (args_info->net_given && ! override)
            continue;
          local_args_info.net_given = 1;
          args_info->net_given = 1;
          if (args_info->net_arg)
            free (args_info->net_arg); /* free previous string */
          args_info->net_arg = gengetopt_strdup (optarg);
          if (args_info->net_orig)
            free (args_info->net_orig); /* free previous string */
          args_info->net_orig = gengetopt_strdup (optarg);
          break;


        case 0:	/* Long option with no short option */
          /* Which modules to print debug messages for.  */
          if (strcmp (long_options[option_index].name, "debugfacility") == 0)
          {
            if (local_args_info.debugfacility_given)
              {
                fprintf (stderr, "%s: `--debugfacility' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->debugfacility_given && ! override)
              continue;
            local_args_info.debugfacility_given = 1;
            args_info->debugfacility_given = 1;
            args_info->debugfacility_arg = strtol (optarg, &stop_char, 0);
            if (!(stop_char && *stop_char == '\0')) {
              fprintf(stderr, "%s: invalid numeric value: %s\n", argv[0], optarg);
              goto failure;
            }
            if (args_info->debugfacility_orig)
              free (args_info->debugfacility_orig); /* free previous string */
            args_info->debugfacility_orig = gengetopt_strdup (optarg);
          }
          /* Which modules to print debug messages for.  */
          else if (strcmp (long_options[option_index].name, "logfacility") == 0)
          {
            if (local_args_info.logfacility_given)
              {
                fprintf (stderr, "%s: `--logfacility' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->logfacility_given && ! override)
              continue;
            local_args_info.logfacility_given = 1;
            args_info->logfacility_given = 1;
            args_info->logfacility_arg = strtol (optarg, &stop_char, 0);
            if (!(stop_char && *stop_char == '\0')) {
              fprintf(stderr, "%s: invalid numeric value: %s\n", argv[0], optarg);
              goto failure;
            }
            if (args_info->logfacility_orig)
              free (args_info->logfacility_orig); /* free previous string */
            args_info->logfacility_orig = gengetopt_strdup (optarg);
          }
          /* Re-read configuration file at this interval.  */
          else if (strcmp (long_options[option_index].name, "interval") == 0)
          {
            if (local_args_info.interval_given)
              {
                fprintf (stderr, "%s: `--interval' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->interval_given && ! override)
              continue;
            local_args_info.interval_given = 1;
            args_info->interval_given = 1;
            args_info->interval_arg = strtol (optarg, &stop_char, 0);
            if (!(stop_char && *stop_char == '\0')) {
              fprintf(stderr, "%s: invalid numeric value: %s\n", argv[0], optarg);
              goto failure;
            }
            if (args_info->interval_orig)
              free (args_info->interval_orig); /* free previous string */
            args_info->interval_orig = gengetopt_strdup (optarg);
          }
          /* Filename of process id file.  */
          else if (strcmp (long_options[option_index].name, "pidfile") == 0)
          {
            if (local_args_info.pidfile_given)
              {
                fprintf (stderr, "%s: `--pidfile' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->pidfile_given && ! override)
              continue;
            local_args_info.pidfile_given = 1;
            args_info->pidfile_given = 1;
            if (args_info->pidfile_arg)
              free (args_info->pidfile_arg); /* free previous string */
            args_info->pidfile_arg = gengetopt_strdup (optarg);
            if (args_info->pidfile_orig)
              free (args_info->pidfile_orig); /* free previous string */
            args_info->pidfile_orig = gengetopt_strdup (optarg);
          }
          /* Directory of nonvolatile data.  */
          else if (strcmp (long_options[option_index].name, "statedir") == 0)
          {
            if (local_args_info.statedir_given)
              {
                fprintf (stderr, "%s: `--statedir' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->statedir_given && ! override)
              continue;
            local_args_info.statedir_given = 1;
            args_info->statedir_given = 1;
            if (args_info->statedir_arg)
              free (args_info->statedir_arg); /* free previous string */
            args_info->statedir_arg = gengetopt_strdup (optarg);
            if (args_info->statedir_orig)
              free (args_info->statedir_orig); /* free previous string */
            args_info->statedir_orig = gengetopt_strdup (optarg);
          }
          /* Network DHCP Starting IP.  */
          else if (strcmp (long_options[option_index].name, "dhcpstart") == 0)
          {
            if (local_args_info.dhcpstart_given)
              {
                fprintf (stderr, "%s: `--dhcpstart' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->dhcpstart_given && ! override)
              continue;
            local_args_info.dhcpstart_given = 1;
            args_info->dhcpstart_given = 1;
            args_info->dhcpstart_arg = strtol (optarg, &stop_char, 0);
            if (!(stop_char && *stop_char == '\0')) {
              fprintf(stderr, "%s: invalid numeric value: %s\n", argv[0], optarg);
              goto failure;
            }
            if (args_info->dhcpstart_orig)
              free (args_info->dhcpstart_orig); /* free previous string */
            args_info->dhcpstart_orig = gengetopt_strdup (optarg);
          }
          /* Network DHCP Ending IP.  */
          else if (strcmp (long_options[option_index].name, "dhcpend") == 0)
          {
            if (local_args_info.dhcpend_given)
              {
                fprintf (stderr, "%s: `--dhcpend' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->dhcpend_given && ! override)
              continue;
            local_args_info.dhcpend_given = 1;
            args_info->dhcpend_given = 1;
            args_info->dhcpend_arg = strtol (optarg, &stop_char, 0);
            if (!(stop_char && *stop_char == '\0')) {
              fprintf(stderr, "%s: invalid numeric value: %s\n", argv[0], optarg);
              goto failure;
            }
            if (args_info->dhcpend_orig)
              free (args_info->dhcpend_orig); /* free previous string */
            args_info->dhcpend_orig = gengetopt_strdup (optarg);
          }
          /* Dynamic IP address pool.  */
          else if (strcmp (long_options[option_index].name, "dynip") == 0)
          {
            if (local_args_info.dynip_given)
              {
                fprintf (stderr, "%s: `--dynip' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->dynip_given && ! override)
              continue;
            local_args_info.dynip_given = 1;
            args_info->dynip_given = 1;
            if (args_info->dynip_arg)
              free (args_info->dynip_arg); /* free previous string */
            args_info->dynip_arg = gengetopt_strdup (optarg);
            if (args_info->dynip_orig)
              free (args_info->dynip_orig); /* free previous string */
            args_info->dynip_orig = gengetopt_strdup (optarg);
          }
          /* Static IP address pool.  */
          else if (strcmp (long_options[option_index].name, "statip") == 0)
          {
            if (local_args_info.statip_given)
              {
                fprintf (stderr, "%s: `--statip' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->statip_given && ! override)
              continue;
            local_args_info.statip_given = 1;
            args_info->statip_given = 1;
            if (args_info->statip_arg)
              free (args_info->statip_arg); /* free previous string */
            args_info->statip_arg = gengetopt_strdup (optarg);
            if (args_info->statip_orig)
              free (args_info->statip_orig); /* free previous string */
            args_info->statip_orig = gengetopt_strdup (optarg);
          }
          /* Primary DNS server IP address.  */
          else if (strcmp (long_options[option_index].name, "dns1") == 0)
          {
            if (local_args_info.dns1_given)
              {
                fprintf (stderr, "%s: `--dns1' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->dns1_given && ! override)
              continue;
            local_args_info.dns1_given = 1;
            args_info->dns1_given = 1;
            if (args_info->dns1_arg)
              free (args_info->dns1_arg); /* free previous string */
            args_info->dns1_arg = gengetopt_strdup (optarg);
            if (args_info->dns1_orig)
              free (args_info->dns1_orig); /* free previous string */
            args_info->dns1_orig = gengetopt_strdup (optarg);
          }
          /* Secondary DNS server IP address.  */
          else if (strcmp (long_options[option_index].name, "dns2") == 0)
          {
            if (local_args_info.dns2_given)
              {
                fprintf (stderr, "%s: `--dns2' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->dns2_given && ! override)
              continue;
            local_args_info.dns2_given = 1;
            args_info->dns2_given = 1;
            if (args_info->dns2_arg)
              free (args_info->dns2_arg); /* free previous string */
            args_info->dns2_arg = gengetopt_strdup (optarg);
            if (args_info->dns2_orig)
              free (args_info->dns2_orig); /* free previous string */
            args_info->dns2_orig = gengetopt_strdup (optarg);
          }
          /* Domain to use for DNS lookups.  */
          else if (strcmp (long_options[option_index].name, "domain") == 0)
          {
            if (local_args_info.domain_given)
              {
                fprintf (stderr, "%s: `--domain' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->domain_given && ! override)
              continue;
            local_args_info.domain_given = 1;
            args_info->domain_given = 1;
            if (args_info->domain_arg)
              free (args_info->domain_arg); /* free previous string */
            args_info->domain_arg = gengetopt_strdup (optarg);
            if (args_info->domain_orig)
              free (args_info->domain_orig); /* free previous string */
            args_info->domain_orig = gengetopt_strdup (optarg);
          }
          /* Script to run after link-up.  */
          else if (strcmp (long_options[option_index].name, "ipup") == 0)
          {
            if (local_args_info.ipup_given)
              {
                fprintf (stderr, "%s: `--ipup' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->ipup_given && ! override)
              continue;
            local_args_info.ipup_given = 1;
            args_info->ipup_given = 1;
            if (args_info->ipup_arg)
              free (args_info->ipup_arg); /* free previous string */
            args_info->ipup_arg = gengetopt_strdup (optarg);
            if (args_info->ipup_orig)
              free (args_info->ipup_orig); /* free previous string */
            args_info->ipup_orig = gengetopt_strdup (optarg);
          }
          /* Script to run after link-down.  */
          else if (strcmp (long_options[option_index].name, "ipdown") == 0)
          {
            if (local_args_info.ipdown_given)
              {
                fprintf (stderr, "%s: `--ipdown' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->ipdown_given && ! override)
              continue;
            local_args_info.ipdown_given = 1;
            args_info->ipdown_given = 1;
            if (args_info->ipdown_arg)
              free (args_info->ipdown_arg); /* free previous string */
            args_info->ipdown_arg = gengetopt_strdup (optarg);
            if (args_info->ipdown_orig)
              free (args_info->ipdown_orig); /* free previous string */
            args_info->ipdown_orig = gengetopt_strdup (optarg);
          }
          /* Script to run after user logon.  */
          else if (strcmp (long_options[option_index].name, "conup") == 0)
          {
            if (local_args_info.conup_given)
              {
                fprintf (stderr, "%s: `--conup' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->conup_given && ! override)
              continue;
            local_args_info.conup_given = 1;
            args_info->conup_given = 1;
            if (args_info->conup_arg)
              free (args_info->conup_arg); /* free previous string */
            args_info->conup_arg = gengetopt_strdup (optarg);
            if (args_info->conup_orig)
              free (args_info->conup_orig); /* free previous string */
            args_info->conup_orig = gengetopt_strdup (optarg);
          }
          /* Script to run after user logoff.  */
          else if (strcmp (long_options[option_index].name, "condown") == 0)
          {
            if (local_args_info.condown_given)
              {
                fprintf (stderr, "%s: `--condown' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->condown_given && ! override)
              continue;
            local_args_info.condown_given = 1;
            args_info->condown_given = 1;
            if (args_info->condown_arg)
              free (args_info->condown_arg); /* free previous string */
            args_info->condown_arg = gengetopt_strdup (optarg);
            if (args_info->condown_orig)
              free (args_info->condown_orig); /* free previous string */
            args_info->condown_orig = gengetopt_strdup (optarg);
          }
          /* TX Queue length for tun interface (linux only).  */
          else if (strcmp (long_options[option_index].name, "txqlen") == 0)
          {
            if (local_args_info.txqlen_given)
              {
                fprintf (stderr, "%s: `--txqlen' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->txqlen_given && ! override)
              continue;
            local_args_info.txqlen_given = 1;
            args_info->txqlen_given = 1;
            args_info->txqlen_arg = strtol (optarg, &stop_char, 0);
            if (!(stop_char && *stop_char == '\0')) {
              fprintf(stderr, "%s: invalid numeric value: %s\n", argv[0], optarg);
              goto failure;
            }
            if (args_info->txqlen_orig)
              free (args_info->txqlen_orig); /* free previous string */
            args_info->txqlen_orig = gengetopt_strdup (optarg);
          }
          /* IP address to send from.  */
          else if (strcmp (long_options[option_index].name, "radiuslisten") == 0)
          {
            if (local_args_info.radiuslisten_given)
              {
                fprintf (stderr, "%s: `--radiuslisten' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->radiuslisten_given && ! override)
              continue;
            local_args_info.radiuslisten_given = 1;
            args_info->radiuslisten_given = 1;
            if (args_info->radiuslisten_arg)
              free (args_info->radiuslisten_arg); /* free previous string */
            args_info->radiuslisten_arg = gengetopt_strdup (optarg);
            if (args_info->radiuslisten_orig)
              free (args_info->radiuslisten_orig); /* free previous string */
            args_info->radiuslisten_orig = gengetopt_strdup (optarg);
          }
          /* IP address of radius server 1.  */
          else if (strcmp (long_options[option_index].name, "radiusserver1") == 0)
          {
            if (local_args_info.radiusserver1_given)
              {
                fprintf (stderr, "%s: `--radiusserver1' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->radiusserver1_given && ! override)
              continue;
            local_args_info.radiusserver1_given = 1;
            args_info->radiusserver1_given = 1;
            if (args_info->radiusserver1_arg)
              free (args_info->radiusserver1_arg); /* free previous string */
            args_info->radiusserver1_arg = gengetopt_strdup (optarg);
            if (args_info->radiusserver1_orig)
              free (args_info->radiusserver1_orig); /* free previous string */
            args_info->radiusserver1_orig = gengetopt_strdup (optarg);
          }
          /* IP address of radius server 2.  */
          else if (strcmp (long_options[option_index].name, "radiusserver2") == 0)
          {
            if (local_args_info.radiusserver2_given)
              {
                fprintf (stderr, "%s: `--radiusserver2' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->radiusserver2_given && ! override)
              continue;
            local_args_info.radiusserver2_given = 1;
            args_info->radiusserver2_given = 1;
            if (args_info->radiusserver2_arg)
              free (args_info->radiusserver2_arg); /* free previous string */
            args_info->radiusserver2_arg = gengetopt_strdup (optarg);
            if (args_info->radiusserver2_orig)
              free (args_info->radiusserver2_orig); /* free previous string */
            args_info->radiusserver2_orig = gengetopt_strdup (optarg);
          }
          /* Authentication UDP port of radius server.  */
          else if (strcmp (long_options[option_index].name, "radiusauthport") == 0)
          {
            if (local_args_info.radiusauthport_given)
              {
                fprintf (stderr, "%s: `--radiusauthport' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->radiusauthport_given && ! override)
              continue;
            local_args_info.radiusauthport_given = 1;
            args_info->radiusauthport_given = 1;
            args_info->radiusauthport_arg = strtol (optarg, &stop_char, 0);
            if (!(stop_char && *stop_char == '\0')) {
              fprintf(stderr, "%s: invalid numeric value: %s\n", argv[0], optarg);
              goto failure;
            }
            if (args_info->radiusauthport_orig)
              free (args_info->radiusauthport_orig); /* free previous string */
            args_info->radiusauthport_orig = gengetopt_strdup (optarg);
          }
          /* Accounting UDP port of radius server.  */
          else if (strcmp (long_options[option_index].name, "radiusacctport") == 0)
          {
            if (local_args_info.radiusacctport_given)
              {
                fprintf (stderr, "%s: `--radiusacctport' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->radiusacctport_given && ! override)
              continue;
            local_args_info.radiusacctport_given = 1;
            args_info->radiusacctport_given = 1;
            args_info->radiusacctport_arg = strtol (optarg, &stop_char, 0);
            if (!(stop_char && *stop_char == '\0')) {
              fprintf(stderr, "%s: invalid numeric value: %s\n", argv[0], optarg);
              goto failure;
            }
            if (args_info->radiusacctport_orig)
              free (args_info->radiusacctport_orig); /* free previous string */
            args_info->radiusacctport_orig = gengetopt_strdup (optarg);
          }
          /* Radius shared secret.  */
          else if (strcmp (long_options[option_index].name, "radiussecret") == 0)
          {
            if (local_args_info.radiussecret_given)
              {
                fprintf (stderr, "%s: `--radiussecret' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->radiussecret_given && ! override)
              continue;
            local_args_info.radiussecret_given = 1;
            args_info->radiussecret_given = 1;
            if (args_info->radiussecret_arg)
              free (args_info->radiussecret_arg); /* free previous string */
            args_info->radiussecret_arg = gengetopt_strdup (optarg);
            if (args_info->radiussecret_orig)
              free (args_info->radiussecret_orig); /* free previous string */
            args_info->radiussecret_orig = gengetopt_strdup (optarg);
          }
          /* Radius NAS-Identifier.  */
          else if (strcmp (long_options[option_index].name, "radiusnasid") == 0)
          {
            if (local_args_info.radiusnasid_given)
              {
                fprintf (stderr, "%s: `--radiusnasid' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->radiusnasid_given && ! override)
              continue;
            local_args_info.radiusnasid_given = 1;
            args_info->radiusnasid_given = 1;
            if (args_info->radiusnasid_arg)
              free (args_info->radiusnasid_arg); /* free previous string */
            args_info->radiusnasid_arg = gengetopt_strdup (optarg);
            if (args_info->radiusnasid_orig)
              free (args_info->radiusnasid_orig); /* free previous string */
            args_info->radiusnasid_orig = gengetopt_strdup (optarg);
          }
          /* WISPr Location ID.  */
          else if (strcmp (long_options[option_index].name, "radiuslocationid") == 0)
          {
            if (local_args_info.radiuslocationid_given)
              {
                fprintf (stderr, "%s: `--radiuslocationid' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->radiuslocationid_given && ! override)
              continue;
            local_args_info.radiuslocationid_given = 1;
            args_info->radiuslocationid_given = 1;
            if (args_info->radiuslocationid_arg)
              free (args_info->radiuslocationid_arg); /* free previous string */
            args_info->radiuslocationid_arg = gengetopt_strdup (optarg);
            if (args_info->radiuslocationid_orig)
              free (args_info->radiuslocationid_orig); /* free previous string */
            args_info->radiuslocationid_orig = gengetopt_strdup (optarg);
          }
          /* WISPr Location Name.  */
          else if (strcmp (long_options[option_index].name, "radiuslocationname") == 0)
          {
            if (local_args_info.radiuslocationname_given)
              {
                fprintf (stderr, "%s: `--radiuslocationname' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->radiuslocationname_given && ! override)
              continue;
            local_args_info.radiuslocationname_given = 1;
            args_info->radiuslocationname_given = 1;
            if (args_info->radiuslocationname_arg)
              free (args_info->radiuslocationname_arg); /* free previous string */
            args_info->radiuslocationname_arg = gengetopt_strdup (optarg);
            if (args_info->radiuslocationname_orig)
              free (args_info->radiuslocationname_orig); /* free previous string */
            args_info->radiuslocationname_orig = gengetopt_strdup (optarg);
          }
          /* Radius NAS-Port-Type.  */
          else if (strcmp (long_options[option_index].name, "radiusnasporttype") == 0)
          {
            if (local_args_info.radiusnasporttype_given)
              {
                fprintf (stderr, "%s: `--radiusnasporttype' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->radiusnasporttype_given && ! override)
              continue;
            local_args_info.radiusnasporttype_given = 1;
            args_info->radiusnasporttype_given = 1;
            args_info->radiusnasporttype_arg = strtol (optarg, &stop_char, 0);
            if (!(stop_char && *stop_char == '\0')) {
              fprintf(stderr, "%s: invalid numeric value: %s\n", argv[0], optarg);
              goto failure;
            }
            if (args_info->radiusnasporttype_orig)
              free (args_info->radiusnasporttype_orig); /* free previous string */
            args_info->radiusnasporttype_orig = gengetopt_strdup (optarg);
          }
          /* Radius disconnect port to listen to.  */
          else if (strcmp (long_options[option_index].name, "coaport") == 0)
          {
            if (local_args_info.coaport_given)
              {
                fprintf (stderr, "%s: `--coaport' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->coaport_given && ! override)
              continue;
            local_args_info.coaport_given = 1;
            args_info->coaport_given = 1;
            args_info->coaport_arg = strtol (optarg, &stop_char, 0);
            if (!(stop_char && *stop_char == '\0')) {
              fprintf(stderr, "%s: invalid numeric value: %s\n", argv[0], optarg);
              goto failure;
            }
            if (args_info->coaport_orig)
              free (args_info->coaport_orig); /* free previous string */
            args_info->coaport_orig = gengetopt_strdup (optarg);
          }
          /* Allow radius disconnect from any IP.  */
          else if (strcmp (long_options[option_index].name, "coanoipcheck") == 0)
          {
            if (local_args_info.coanoipcheck_given)
              {
                fprintf (stderr, "%s: `--coanoipcheck' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->coanoipcheck_given && ! override)
              continue;
            local_args_info.coanoipcheck_given = 1;
            args_info->coanoipcheck_given = 1;
            args_info->coanoipcheck_flag = !(args_info->coanoipcheck_flag);
          }
          /* IP address to listen to.  */
          else if (strcmp (long_options[option_index].name, "proxylisten") == 0)
          {
            if (local_args_info.proxylisten_given)
              {
                fprintf (stderr, "%s: `--proxylisten' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->proxylisten_given && ! override)
              continue;
            local_args_info.proxylisten_given = 1;
            args_info->proxylisten_given = 1;
            if (args_info->proxylisten_arg)
              free (args_info->proxylisten_arg); /* free previous string */
            args_info->proxylisten_arg = gengetopt_strdup (optarg);
            if (args_info->proxylisten_orig)
              free (args_info->proxylisten_orig); /* free previous string */
            args_info->proxylisten_orig = gengetopt_strdup (optarg);
          }
          /* UDP port to listen to.  */
          else if (strcmp (long_options[option_index].name, "proxyport") == 0)
          {
            if (local_args_info.proxyport_given)
              {
                fprintf (stderr, "%s: `--proxyport' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->proxyport_given && ! override)
              continue;
            local_args_info.proxyport_given = 1;
            args_info->proxyport_given = 1;
            args_info->proxyport_arg = strtol (optarg, &stop_char, 0);
            if (!(stop_char && *stop_char == '\0')) {
              fprintf(stderr, "%s: invalid numeric value: %s\n", argv[0], optarg);
              goto failure;
            }
            if (args_info->proxyport_orig)
              free (args_info->proxyport_orig); /* free previous string */
            args_info->proxyport_orig = gengetopt_strdup (optarg);
          }
          /* IP address of proxy client(s).  */
          else if (strcmp (long_options[option_index].name, "proxyclient") == 0)
          {
            if (local_args_info.proxyclient_given)
              {
                fprintf (stderr, "%s: `--proxyclient' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->proxyclient_given && ! override)
              continue;
            local_args_info.proxyclient_given = 1;
            args_info->proxyclient_given = 1;
            if (args_info->proxyclient_arg)
              free (args_info->proxyclient_arg); /* free previous string */
            args_info->proxyclient_arg = gengetopt_strdup (optarg);
            if (args_info->proxyclient_orig)
              free (args_info->proxyclient_orig); /* free previous string */
            args_info->proxyclient_orig = gengetopt_strdup (optarg);
          }
          /* Radius proxy shared secret.  */
          else if (strcmp (long_options[option_index].name, "proxysecret") == 0)
          {
            if (local_args_info.proxysecret_given)
              {
                fprintf (stderr, "%s: `--proxysecret' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->proxysecret_given && ! override)
              continue;
            local_args_info.proxysecret_given = 1;
            args_info->proxysecret_given = 1;
            if (args_info->proxysecret_arg)
              free (args_info->proxysecret_arg); /* free previous string */
            args_info->proxysecret_arg = gengetopt_strdup (optarg);
            if (args_info->proxysecret_orig)
              free (args_info->proxysecret_orig); /* free previous string */
            args_info->proxysecret_orig = gengetopt_strdup (optarg);
          }
          /* Local Ethernet interface.  */
          else if (strcmp (long_options[option_index].name, "dhcpif") == 0)
          {
            if (local_args_info.dhcpif_given)
              {
                fprintf (stderr, "%s: `--dhcpif' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->dhcpif_given && ! override)
              continue;
            local_args_info.dhcpif_given = 1;
            args_info->dhcpif_given = 1;
            if (args_info->dhcpif_arg)
              free (args_info->dhcpif_arg); /* free previous string */
            args_info->dhcpif_arg = gengetopt_strdup (optarg);
            if (args_info->dhcpif_orig)
              free (args_info->dhcpif_orig); /* free previous string */
            args_info->dhcpif_orig = gengetopt_strdup (optarg);
          }
          /* Interface MAC address.  */
          else if (strcmp (long_options[option_index].name, "dhcpmac") == 0)
          {
            if (local_args_info.dhcpmac_given)
              {
                fprintf (stderr, "%s: `--dhcpmac' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->dhcpmac_given && ! override)
              continue;
            local_args_info.dhcpmac_given = 1;
            args_info->dhcpmac_given = 1;
            if (args_info->dhcpmac_arg)
              free (args_info->dhcpmac_arg); /* free previous string */
            args_info->dhcpmac_arg = gengetopt_strdup (optarg);
            if (args_info->dhcpmac_orig)
              free (args_info->dhcpmac_orig); /* free previous string */
            args_info->dhcpmac_orig = gengetopt_strdup (optarg);
          }
          /* Lease time to allocate to clients.  */
          else if (strcmp (long_options[option_index].name, "lease") == 0)
          {
            if (local_args_info.lease_given)
              {
                fprintf (stderr, "%s: `--lease' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->lease_given && ! override)
              continue;
            local_args_info.lease_given = 1;
            args_info->lease_given = 1;
            args_info->lease_arg = strtol (optarg, &stop_char, 0);
            if (!(stop_char && *stop_char == '\0')) {
              fprintf(stderr, "%s: invalid numeric value: %s\n", argv[0], optarg);
              goto failure;
            }
            if (args_info->lease_orig)
              free (args_info->lease_orig); /* free previous string */
            args_info->lease_orig = gengetopt_strdup (optarg);
          }
          /* Enable IEEE 802.1x authentication.  */
          else if (strcmp (long_options[option_index].name, "eapolenable") == 0)
          {
            if (local_args_info.eapolenable_given)
              {
                fprintf (stderr, "%s: `--eapolenable' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->eapolenable_given && ! override)
              continue;
            local_args_info.eapolenable_given = 1;
            args_info->eapolenable_given = 1;
            args_info->eapolenable_flag = !(args_info->eapolenable_flag);
          }
          /* URL of authentication web server.  */
          else if (strcmp (long_options[option_index].name, "uamserver") == 0)
          {
            if (local_args_info.uamserver_given)
              {
                fprintf (stderr, "%s: `--uamserver' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->uamserver_given && ! override)
              continue;
            local_args_info.uamserver_given = 1;
            args_info->uamserver_given = 1;
            if (args_info->uamserver_arg)
              free (args_info->uamserver_arg); /* free previous string */
            args_info->uamserver_arg = gengetopt_strdup (optarg);
            if (args_info->uamserver_orig)
              free (args_info->uamserver_orig); /* free previous string */
            args_info->uamserver_orig = gengetopt_strdup (optarg);
          }
          /* URL of homepage to redirect unauthenticated users to.  */
          else if (strcmp (long_options[option_index].name, "uamhomepage") == 0)
          {
            if (local_args_info.uamhomepage_given)
              {
                fprintf (stderr, "%s: `--uamhomepage' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->uamhomepage_given && ! override)
              continue;
            local_args_info.uamhomepage_given = 1;
            args_info->uamhomepage_given = 1;
            if (args_info->uamhomepage_arg)
              free (args_info->uamhomepage_arg); /* free previous string */
            args_info->uamhomepage_arg = gengetopt_strdup (optarg);
            if (args_info->uamhomepage_orig)
              free (args_info->uamhomepage_orig); /* free previous string */
            args_info->uamhomepage_orig = gengetopt_strdup (optarg);
          }
          /* Shared secret between uamserver and chilli.  */
          else if (strcmp (long_options[option_index].name, "uamsecret") == 0)
          {
            if (local_args_info.uamsecret_given)
              {
                fprintf (stderr, "%s: `--uamsecret' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->uamsecret_given && ! override)
              continue;
            local_args_info.uamsecret_given = 1;
            args_info->uamsecret_given = 1;
            if (args_info->uamsecret_arg)
              free (args_info->uamsecret_arg); /* free previous string */
            args_info->uamsecret_arg = gengetopt_strdup (optarg);
            if (args_info->uamsecret_orig)
              free (args_info->uamsecret_orig); /* free previous string */
            args_info->uamsecret_orig = gengetopt_strdup (optarg);
          }
          /* IP address to listen to for authentication requests.  */
          else if (strcmp (long_options[option_index].name, "uamlisten") == 0)
          {
            if (local_args_info.uamlisten_given)
              {
                fprintf (stderr, "%s: `--uamlisten' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->uamlisten_given && ! override)
              continue;
            local_args_info.uamlisten_given = 1;
            args_info->uamlisten_given = 1;
            if (args_info->uamlisten_arg)
              free (args_info->uamlisten_arg); /* free previous string */
            args_info->uamlisten_arg = gengetopt_strdup (optarg);
            if (args_info->uamlisten_orig)
              free (args_info->uamlisten_orig); /* free previous string */
            args_info->uamlisten_orig = gengetopt_strdup (optarg);
          }
          /* TCP port to bind to for authentication requests.  */
          else if (strcmp (long_options[option_index].name, "uamport") == 0)
          {
            if (local_args_info.uamport_given)
              {
                fprintf (stderr, "%s: `--uamport' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->uamport_given && ! override)
              continue;
            local_args_info.uamport_given = 1;
            args_info->uamport_given = 1;
            args_info->uamport_arg = strtol (optarg, &stop_char, 0);
            if (!(stop_char && *stop_char == '\0')) {
              fprintf(stderr, "%s: invalid numeric value: %s\n", argv[0], optarg);
              goto failure;
            }
            if (args_info->uamport_orig)
              free (args_info->uamport_orig); /* free previous string */
            args_info->uamport_orig = gengetopt_strdup (optarg);
          }
          /* TCP port to bind to for UAM UI requests.  */
          else if (strcmp (long_options[option_index].name, "uamuiport") == 0)
          {
            if (local_args_info.uamuiport_given)
              {
                fprintf (stderr, "%s: `--uamuiport' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->uamuiport_given && ! override)
              continue;
            local_args_info.uamuiport_given = 1;
            args_info->uamuiport_given = 1;
            args_info->uamuiport_arg = strtol (optarg, &stop_char, 0);
            if (!(stop_char && *stop_char == '\0')) {
              fprintf(stderr, "%s: invalid numeric value: %s\n", argv[0], optarg);
              goto failure;
            }
            if (args_info->uamuiport_orig)
              free (args_info->uamuiport_orig); /* free previous string */
            args_info->uamuiport_orig = gengetopt_strdup (optarg);
          }
          /* Domain names exempt from access check .  */
          else if (strcmp (long_options[option_index].name, "uamallowed") == 0)
          {
            local_args_info.uamallowed_given++;
          
            multi_token = get_multiple_arg_token(optarg);
            multi_next = get_multiple_arg_token_next (optarg);
          
            while (1)
              {
                uamallowed_new = (struct string_list *) malloc (sizeof (struct string_list));
                uamallowed_new->next = uamallowed_list;
                uamallowed_list = uamallowed_new;
                uamallowed_new->arg = gengetopt_strdup (multi_token);
                uamallowed_new->orig = multi_token;
          
                if (multi_next)
                  {
                    multi_token = get_multiple_arg_token(multi_next);
                    multi_next = get_multiple_arg_token_next (multi_next);
                    local_args_info.uamallowed_given++;
                  }
                else
                  break;
              }
            break;
          }
          /* Allow client to use any DNS server.  */
          else if (strcmp (long_options[option_index].name, "uamanydns") == 0)
          {
            if (local_args_info.uamanydns_given)
              {
                fprintf (stderr, "%s: `--uamanydns' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->uamanydns_given && ! override)
              continue;
            local_args_info.uamanydns_given = 1;
            args_info->uamanydns_given = 1;
            args_info->uamanydns_flag = !(args_info->uamanydns_flag);
          }
          /* Allow client to use any IP Address.  */
          else if (strcmp (long_options[option_index].name, "uamanyip") == 0)
          {
            if (local_args_info.uamanyip_given)
              {
                fprintf (stderr, "%s: `--uamanyip' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->uamanyip_given && ! override)
              continue;
            local_args_info.uamanyip_given = 1;
            args_info->uamanyip_given = 1;
            args_info->uamanyip_flag = !(args_info->uamanyip_flag);
          }
          /* Do not return to the UAM server on success, original url instead.  */
          else if (strcmp (long_options[option_index].name, "nouamsuccess") == 0)
          {
            if (local_args_info.nouamsuccess_given)
              {
                fprintf (stderr, "%s: `--nouamsuccess' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->nouamsuccess_given && ! override)
              continue;
            local_args_info.nouamsuccess_given = 1;
            args_info->nouamsuccess_given = 1;
            args_info->nouamsuccess_flag = !(args_info->nouamsuccess_flag);
          }
          /* Do not send WISPr XML from ChilliSpot, assume back-end does.  */
          else if (strcmp (long_options[option_index].name, "nouamwispr") == 0)
          {
            if (local_args_info.nouamwispr_given)
              {
                fprintf (stderr, "%s: `--nouamwispr' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->nouamwispr_given && ! override)
              continue;
            local_args_info.nouamwispr_given = 1;
            args_info->nouamwispr_given = 1;
            args_info->nouamwispr_flag = !(args_info->nouamwispr_flag);
          }
          /* HTTP Auto-Logout IP Address.  */
          else if (strcmp (long_options[option_index].name, "uamlogoutip") == 0)
          {
            if (local_args_info.uamlogoutip_given)
              {
                fprintf (stderr, "%s: `--uamlogoutip' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->uamlogoutip_given && ! override)
              continue;
            local_args_info.uamlogoutip_given = 1;
            args_info->uamlogoutip_given = 1;
            if (args_info->uamlogoutip_arg)
              free (args_info->uamlogoutip_arg); /* free previous string */
            args_info->uamlogoutip_arg = gengetopt_strdup (optarg);
            if (args_info->uamlogoutip_orig)
              free (args_info->uamlogoutip_orig); /* free previous string */
            args_info->uamlogoutip_orig = gengetopt_strdup (optarg);
          }
          /* Authenticate based on MAC address.  */
          else if (strcmp (long_options[option_index].name, "macauth") == 0)
          {
            if (local_args_info.macauth_given)
              {
                fprintf (stderr, "%s: `--macauth' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->macauth_given && ! override)
              continue;
            local_args_info.macauth_given = 1;
            args_info->macauth_given = 1;
            args_info->macauth_flag = !(args_info->macauth_flag);
          }
          /* List of allowed MAC addresses.  */
          else if (strcmp (long_options[option_index].name, "macallowed") == 0)
          {
            local_args_info.macallowed_given++;
          
            multi_token = get_multiple_arg_token(optarg);
            multi_next = get_multiple_arg_token_next (optarg);
          
            while (1)
              {
                macallowed_new = (struct string_list *) malloc (sizeof (struct string_list));
                macallowed_new->next = macallowed_list;
                macallowed_list = macallowed_new;
                macallowed_new->arg = gengetopt_strdup (multi_token);
                macallowed_new->orig = multi_token;
          
                if (multi_next)
                  {
                    multi_token = get_multiple_arg_token(multi_next);
                    multi_next = get_multiple_arg_token_next (multi_next);
                    local_args_info.macallowed_given++;
                  }
                else
                  break;
              }
            break;
          }
          /* Suffix to add to the MAC address.  */
          else if (strcmp (long_options[option_index].name, "macsuffix") == 0)
          {
            if (local_args_info.macsuffix_given)
              {
                fprintf (stderr, "%s: `--macsuffix' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->macsuffix_given && ! override)
              continue;
            local_args_info.macsuffix_given = 1;
            args_info->macsuffix_given = 1;
            if (args_info->macsuffix_arg)
              free (args_info->macsuffix_arg); /* free previous string */
            args_info->macsuffix_arg = gengetopt_strdup (optarg);
            if (args_info->macsuffix_orig)
              free (args_info->macsuffix_orig); /* free previous string */
            args_info->macsuffix_orig = gengetopt_strdup (optarg);
          }
          /* Password used when performing MAC authentication.  */
          else if (strcmp (long_options[option_index].name, "macpasswd") == 0)
          {
            if (local_args_info.macpasswd_given)
              {
                fprintf (stderr, "%s: `--macpasswd' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->macpasswd_given && ! override)
              continue;
            local_args_info.macpasswd_given = 1;
            args_info->macpasswd_given = 1;
            if (args_info->macpasswd_arg)
              free (args_info->macpasswd_arg); /* free previous string */
            args_info->macpasswd_arg = gengetopt_strdup (optarg);
            if (args_info->macpasswd_orig)
              free (args_info->macpasswd_orig); /* free previous string */
            args_info->macpasswd_orig = gengetopt_strdup (optarg);
          }
          /* Do not use RADIUS for authenticating the macallowed.  */
          else if (strcmp (long_options[option_index].name, "macallowlocal") == 0)
          {
            if (local_args_info.macallowlocal_given)
              {
                fprintf (stderr, "%s: `--macallowlocal' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->macallowlocal_given && ! override)
              continue;
            local_args_info.macallowlocal_given = 1;
            args_info->macallowlocal_given = 1;
            args_info->macallowlocal_flag = !(args_info->macallowlocal_flag);
          }
          /* Local content served by chilli (for splash page, etc).  */
          else if (strcmp (long_options[option_index].name, "wwwdir") == 0)
          {
            if (local_args_info.wwwdir_given)
              {
                fprintf (stderr, "%s: `--wwwdir' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->wwwdir_given && ! override)
              continue;
            local_args_info.wwwdir_given = 1;
            args_info->wwwdir_given = 1;
            if (args_info->wwwdir_arg)
              free (args_info->wwwdir_arg); /* free previous string */
            args_info->wwwdir_arg = gengetopt_strdup (optarg);
            if (args_info->wwwdir_orig)
              free (args_info->wwwdir_orig); /* free previous string */
            args_info->wwwdir_orig = gengetopt_strdup (optarg);
          }
          /* Script binary (such as haserl) for simple web programming.  */
          else if (strcmp (long_options[option_index].name, "wwwbin") == 0)
          {
            if (local_args_info.wwwbin_given)
              {
                fprintf (stderr, "%s: `--wwwbin' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->wwwbin_given && ! override)
              continue;
            local_args_info.wwwbin_given = 1;
            args_info->wwwbin_given = 1;
            if (args_info->wwwbin_arg)
              free (args_info->wwwbin_arg); /* free previous string */
            args_info->wwwbin_arg = gengetopt_strdup (optarg);
            if (args_info->wwwbin_orig)
              free (args_info->wwwbin_orig); /* free previous string */
            args_info->wwwbin_orig = gengetopt_strdup (optarg);
          }
          /* Program in inetd style to handle all uam requests.  */
          else if (strcmp (long_options[option_index].name, "uamui") == 0)
          {
            if (local_args_info.uamui_given)
              {
                fprintf (stderr, "%s: `--uamui' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->uamui_given && ! override)
              continue;
            local_args_info.uamui_given = 1;
            args_info->uamui_given = 1;
            if (args_info->uamui_arg)
              free (args_info->uamui_arg); /* free previous string */
            args_info->uamui_arg = gengetopt_strdup (optarg);
            if (args_info->uamui_orig)
              free (args_info->uamui_orig); /* free previous string */
            args_info->uamui_orig = gengetopt_strdup (optarg);
          }
          /* RADIUS administrative user login username.  */
          else if (strcmp (long_options[option_index].name, "adminuser") == 0)
          {
            if (local_args_info.adminuser_given)
              {
                fprintf (stderr, "%s: `--adminuser' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->adminuser_given && ! override)
              continue;
            local_args_info.adminuser_given = 1;
            args_info->adminuser_given = 1;
            if (args_info->adminuser_arg)
              free (args_info->adminuser_arg); /* free previous string */
            args_info->adminuser_arg = gengetopt_strdup (optarg);
            if (args_info->adminuser_orig)
              free (args_info->adminuser_orig); /* free previous string */
            args_info->adminuser_orig = gengetopt_strdup (optarg);
          }
          /* RADIUS administrative user login password.  */
          else if (strcmp (long_options[option_index].name, "adminpasswd") == 0)
          {
            if (local_args_info.adminpasswd_given)
              {
                fprintf (stderr, "%s: `--adminpasswd' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->adminpasswd_given && ! override)
              continue;
            local_args_info.adminpasswd_given = 1;
            args_info->adminpasswd_given = 1;
            if (args_info->adminpasswd_arg)
              free (args_info->adminpasswd_arg); /* free previous string */
            args_info->adminpasswd_arg = gengetopt_strdup (optarg);
            if (args_info->adminpasswd_orig)
              free (args_info->adminpasswd_orig); /* free previous string */
            args_info->adminpasswd_orig = gengetopt_strdup (optarg);
          }
          /* Unique MAC address of the NAS (called-station-id).  */
          else if (strcmp (long_options[option_index].name, "nasmac") == 0)
          {
            if (local_args_info.nasmac_given)
              {
                fprintf (stderr, "%s: `--nasmac' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->nasmac_given && ! override)
              continue;
            local_args_info.nasmac_given = 1;
            args_info->nasmac_given = 1;
            if (args_info->nasmac_arg)
              free (args_info->nasmac_arg); /* free previous string */
            args_info->nasmac_arg = gengetopt_strdup (optarg);
            if (args_info->nasmac_orig)
              free (args_info->nasmac_orig); /* free previous string */
            args_info->nasmac_orig = gengetopt_strdup (optarg);
          }
          /* Unique IP address of the NAS (nas-ip-address).  */
          else if (strcmp (long_options[option_index].name, "nasip") == 0)
          {
            if (local_args_info.nasip_given)
              {
                fprintf (stderr, "%s: `--nasip' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->nasip_given && ! override)
              continue;
            local_args_info.nasip_given = 1;
            args_info->nasip_given = 1;
            if (args_info->nasip_arg)
              free (args_info->nasip_arg); /* free previous string */
            args_info->nasip_arg = gengetopt_strdup (optarg);
            if (args_info->nasip_orig)
              free (args_info->nasip_orig); /* free previous string */
            args_info->nasip_orig = gengetopt_strdup (optarg);
          }
          /* SSID of the session.  */
          else if (strcmp (long_options[option_index].name, "ssid") == 0)
          {
            if (local_args_info.ssid_given)
              {
                fprintf (stderr, "%s: `--ssid' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->ssid_given && ! override)
              continue;
            local_args_info.ssid_given = 1;
            args_info->ssid_given = 1;
            if (args_info->ssid_arg)
              free (args_info->ssid_arg); /* free previous string */
            args_info->ssid_arg = gengetopt_strdup (optarg);
            if (args_info->ssid_orig)
              free (args_info->ssid_orig); /* free previous string */
            args_info->ssid_orig = gengetopt_strdup (optarg);
          }
          /* VLAN of the session.  */
          else if (strcmp (long_options[option_index].name, "vlan") == 0)
          {
            if (local_args_info.vlan_given)
              {
                fprintf (stderr, "%s: `--vlan' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->vlan_given && ! override)
              continue;
            local_args_info.vlan_given = 1;
            args_info->vlan_given = 1;
            if (args_info->vlan_arg)
              free (args_info->vlan_arg); /* free previous string */
            args_info->vlan_arg = gengetopt_strdup (optarg);
            if (args_info->vlan_orig)
              free (args_info->vlan_orig); /* free previous string */
            args_info->vlan_orig = gengetopt_strdup (optarg);
          }
          /* path to the command unix socket.  */
          else if (strcmp (long_options[option_index].name, "cmdsocket") == 0)
          {
            if (local_args_info.cmdsocket_given)
              {
                fprintf (stderr, "%s: `--cmdsocket' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->cmdsocket_given && ! override)
              continue;
            local_args_info.cmdsocket_given = 1;
            args_info->cmdsocket_given = 1;
            if (args_info->cmdsocket_arg)
              free (args_info->cmdsocket_arg); /* free previous string */
            args_info->cmdsocket_arg = gengetopt_strdup (optarg);
            if (args_info->cmdsocket_orig)
              free (args_info->cmdsocket_orig); /* free previous string */
            args_info->cmdsocket_orig = gengetopt_strdup (optarg);
          }
          /* Swap the meaning of input/output octets/packets.  */
          else if (strcmp (long_options[option_index].name, "swapoctets") == 0)
          {
            if (local_args_info.swapoctets_given)
              {
                fprintf (stderr, "%s: `--swapoctets' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->swapoctets_given && ! override)
              continue;
            local_args_info.swapoctets_given = 1;
            args_info->swapoctets_given = 1;
            args_info->swapoctets_flag = !(args_info->swapoctets_flag);
          }
          /* Use the status file to keep track of sessions.  */
          else if (strcmp (long_options[option_index].name, "usestatusfile") == 0)
          {
            if (local_args_info.usestatusfile_given)
              {
                fprintf (stderr, "%s: `--usestatusfile' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->usestatusfile_given && ! override)
              continue;
            local_args_info.usestatusfile_given = 1;
            args_info->usestatusfile_given = 1;
            args_info->usestatusfile_flag = !(args_info->usestatusfile_flag);
          }
          /* File keep 'Local' usernames and passwords.  */
          else if (strcmp (long_options[option_index].name, "localusers") == 0)
          {
            if (local_args_info.localusers_given)
              {
                fprintf (stderr, "%s: `--localusers' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->localusers_given && ! override)
              continue;
            local_args_info.localusers_given = 1;
            args_info->localusers_given = 1;
            if (args_info->localusers_arg)
              free (args_info->localusers_arg); /* free previous string */
            args_info->localusers_arg = gengetopt_strdup (optarg);
            if (args_info->localusers_orig)
              free (args_info->localusers_orig); /* free previous string */
            args_info->localusers_orig = gengetopt_strdup (optarg);
          }
          /* IP of an upstream transparent proxy.  */
          else if (strcmp (long_options[option_index].name, "postauthproxy") == 0)
          {
            if (local_args_info.postauthproxy_given)
              {
                fprintf (stderr, "%s: `--postauthproxy' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->postauthproxy_given && ! override)
              continue;
            local_args_info.postauthproxy_given = 1;
            args_info->postauthproxy_given = 1;
            if (args_info->postauthproxy_arg)
              free (args_info->postauthproxy_arg); /* free previous string */
            args_info->postauthproxy_arg = gengetopt_strdup (optarg);
            if (args_info->postauthproxy_orig)
              free (args_info->postauthproxy_orig); /* free previous string */
            args_info->postauthproxy_orig = gengetopt_strdup (optarg);
          }
          /* Port of an upstream transparent proxy.  */
          else if (strcmp (long_options[option_index].name, "postauthproxyport") == 0)
          {
            if (local_args_info.postauthproxyport_given)
              {
                fprintf (stderr, "%s: `--postauthproxyport' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->postauthproxyport_given && ! override)
              continue;
            local_args_info.postauthproxyport_given = 1;
            args_info->postauthproxyport_given = 1;
            args_info->postauthproxyport_arg = strtol (optarg, &stop_char, 0);
            if (!(stop_char && *stop_char == '\0')) {
              fprintf(stderr, "%s: invalid numeric value: %s\n", argv[0], optarg);
              goto failure;
            }
            if (args_info->postauthproxyport_orig)
              free (args_info->postauthproxyport_orig); /* free previous string */
            args_info->postauthproxyport_orig = gengetopt_strdup (optarg);
          }
          /* Allow WPA 'Guest' access.  */
          else if (strcmp (long_options[option_index].name, "wpaguests") == 0)
          {
            if (local_args_info.wpaguests_given)
              {
                fprintf (stderr, "%s: `--wpaguests' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->wpaguests_given && ! override)
              continue;
            local_args_info.wpaguests_given = 1;
            args_info->wpaguests_given = 1;
            args_info->wpaguests_flag = !(args_info->wpaguests_flag);
          }
          /* Always allow 'PAP' (password) style authentication (not advised).  */
          else if (strcmp (long_options[option_index].name, "papalwaysok") == 0)
          {
            if (local_args_info.papalwaysok_given)
              {
                fprintf (stderr, "%s: `--papalwaysok' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->papalwaysok_given && ! override)
              continue;
            local_args_info.papalwaysok_given = 1;
            args_info->papalwaysok_given = 1;
            args_info->papalwaysok_flag = !(args_info->papalwaysok_flag);
          }
          /* Use ChilliSpot XML in WISPr blocks.  */
          else if (strcmp (long_options[option_index].name, "chillixml") == 0)
          {
            if (local_args_info.chillixml_given)
              {
                fprintf (stderr, "%s: `--chillixml' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->chillixml_given && ! override)
              continue;
            local_args_info.chillixml_given = 1;
            args_info->chillixml_given = 1;
            args_info->chillixml_flag = !(args_info->chillixml_flag);
          }
          /* Use a TAP instead of TUN (linux only).  */
          else if (strcmp (long_options[option_index].name, "usetap") == 0)
          {
            if (local_args_info.usetap_given)
              {
                fprintf (stderr, "%s: `--usetap' option given more than once%s\n", argv[0], (additional_error ? additional_error : ""));
                goto failure;
              }
            if (args_info->usetap_given && ! override)
              continue;
            local_args_info.usetap_given = 1;
            args_info->usetap_given = 1;
            args_info->usetap_flag = !(args_info->usetap_flag);
          }
          
          break;
        case '?':	/* Invalid option.  */
          /* `getopt_long' already printed an error message.  */
          goto failure;

        default:	/* bug: option not considered.  */
          fprintf (stderr, "%s: option unknown: %c%s\n", CMDLINE_PARSER_PACKAGE, c, (additional_error ? additional_error : ""));
          abort ();
        } /* switch */
    } /* while */


  if (local_args_info.uamallowed_given && uamallowed_list)
    {
      struct string_list *tmp;
      args_info->uamallowed_arg = (char * *) realloc (args_info->uamallowed_arg, (args_info->uamallowed_given + local_args_info.uamallowed_given) * sizeof (char *));
      args_info->uamallowed_orig = (char **) realloc (args_info->uamallowed_orig, (args_info->uamallowed_given + local_args_info.uamallowed_given) * sizeof (char *));
      for (i = (local_args_info.uamallowed_given - 1); i >= 0; --i)
        {
          tmp = uamallowed_list;
          args_info->uamallowed_arg [i + args_info->uamallowed_given] = uamallowed_list->arg;
          args_info->uamallowed_orig [i + args_info->uamallowed_given] = uamallowed_list->orig;
          uamallowed_list = uamallowed_list->next;
          free (tmp);
        }
    }
  
  if (local_args_info.macallowed_given && macallowed_list)
    {
      struct string_list *tmp;
      args_info->macallowed_arg = (char * *) realloc (args_info->macallowed_arg, (args_info->macallowed_given + local_args_info.macallowed_given) * sizeof (char *));
      args_info->macallowed_orig = (char **) realloc (args_info->macallowed_orig, (args_info->macallowed_given + local_args_info.macallowed_given) * sizeof (char *));
      for (i = (local_args_info.macallowed_given - 1); i >= 0; --i)
        {
          tmp = macallowed_list;
          args_info->macallowed_arg [i + args_info->macallowed_given] = macallowed_list->arg;
          args_info->macallowed_orig [i + args_info->macallowed_given] = macallowed_list->orig;
          macallowed_list = macallowed_list->next;
          free (tmp);
        }
    }
  

  args_info->uamallowed_given += local_args_info.uamallowed_given;
  local_args_info.uamallowed_given = 0;
  args_info->macallowed_given += local_args_info.macallowed_given;
  local_args_info.macallowed_given = 0;
  
  if (check_required)
    {
      error += cmdline_parser_required2 (args_info, argv[0], additional_error);
    }

  cmdline_parser_release (&local_args_info);

  if ( error )
    return (EXIT_FAILURE);

  return 0;

failure:
  if (uamallowed_list)
    {
      struct string_list *tmp;
      while (uamallowed_list)
        {
          tmp = uamallowed_list;
          free (uamallowed_list->arg);
          free (uamallowed_list->orig);
          uamallowed_list = uamallowed_list->next;
          free (tmp);
        }
    }
  if (macallowed_list)
    {
      struct string_list *tmp;
      while (macallowed_list)
        {
          tmp = macallowed_list;
          free (macallowed_list->arg);
          free (macallowed_list->orig);
          macallowed_list = macallowed_list->next;
          free (tmp);
        }
    }
  
  cmdline_parser_release (&local_args_info);
  return (EXIT_FAILURE);
}

#ifndef CONFIG_FILE_LINE_SIZE
#define CONFIG_FILE_LINE_SIZE 2048
#endif
#define ADDITIONAL_ERROR " in configuration file "

#define CONFIG_FILE_LINE_BUFFER_SIZE (CONFIG_FILE_LINE_SIZE+3)
/* 3 is for "--" and "=" */

static int
_cmdline_parser_configfile (char * const filename, int *my_argc)
{
  FILE* file;
  char my_argv[CONFIG_FILE_LINE_BUFFER_SIZE+1];
  char linebuf[CONFIG_FILE_LINE_SIZE];
  int line_num = 0;
  int result = 0, equal;
  char *fopt, *farg;
  char *str_index;
  size_t len, next_token;
  char delimiter;

  if ((file = fopen(filename, "r")) == NULL)
    {
      fprintf (stderr, "%s: Error opening configuration file '%s'\n",
               CMDLINE_PARSER_PACKAGE, filename);
      return EXIT_FAILURE;
    }

  while ((fgets(linebuf, CONFIG_FILE_LINE_SIZE, file)) != NULL)
    {
      ++line_num;
      my_argv[0] = '\0';
      len = strlen(linebuf);
      if (len > (CONFIG_FILE_LINE_BUFFER_SIZE-1))
        {
          fprintf (stderr, "%s:%s:%d: Line too long in configuration file\n",
                   CMDLINE_PARSER_PACKAGE, filename, line_num);
          result = EXIT_FAILURE;
          break;
        }

      /* find first non-whitespace character in the line */
      next_token = strspn (linebuf, " \t\r\n");
      str_index  = linebuf + next_token;

      if ( str_index[0] == '\0' || str_index[0] == '#')
        continue; /* empty line or comment line is skipped */

      fopt = str_index;

      /* truncate fopt at the end of the first non-valid character */
      next_token = strcspn (fopt, " \t\r\n=");

      if (fopt[next_token] == '\0') /* the line is over */
        {
          farg  = NULL;
          equal = 0;
          goto noarg;
        }

      /* remember if equal sign is present */
      equal = (fopt[next_token] == '=');
      fopt[next_token++] = '\0';

      /* advance pointers to the next token after the end of fopt */
      next_token += strspn (fopt + next_token, " \t\r\n");

      /* check for the presence of equal sign, and if so, skip it */
      if ( !equal )
        if ((equal = (fopt[next_token] == '=')))
          {
            next_token++;
            next_token += strspn (fopt + next_token, " \t\r\n");
          }
      str_index  += next_token;

      /* find argument */
      farg = str_index;
      if ( farg[0] == '\"' || farg[0] == '\'' )
        { /* quoted argument */
          str_index = strchr (++farg, str_index[0] ); /* skip opening quote */
          if (! str_index)
            {
              fprintf
                (stderr,
                 "%s:%s:%d: unterminated string in configuration file\n",
                 CMDLINE_PARSER_PACKAGE, filename, line_num);
              result = EXIT_FAILURE;
              break;
            }
        }
      else
        { /* read up the remaining part up to a delimiter */
          next_token = strcspn (farg, " \t\r\n#\'\"");
          str_index += next_token;
        }

      /* truncate farg at the delimiter and store it for further check */
      delimiter = *str_index, *str_index++ = '\0';

      /* everything but comment is illegal at the end of line */
      if (delimiter != '\0' && delimiter != '#')
        {
          str_index += strspn(str_index, " \t\r\n");
          if (*str_index != '\0' && *str_index != '#')
            {
              fprintf
                (stderr,
                 "%s:%s:%d: malformed string in configuration file\n",
                 CMDLINE_PARSER_PACKAGE, filename, line_num);
              result = EXIT_FAILURE;
              break;
            }
        }

    noarg:
      if (!strcmp(fopt,"include")) {
        if (farg && *farg) {
          result = _cmdline_parser_configfile(farg, my_argc);
        } else {
          fprintf(stderr, "%s:%s:%d: include requires a filename argument.\n",
                  CMDLINE_PARSER_PACKAGE, filename, line_num);
        }
        continue;
      }
      len = strlen(fopt);
      strcat (my_argv, len > 1 ? "--" : "-");
      strcat (my_argv, fopt);
      if (len > 1 && ((farg && *farg) || equal))
        strcat (my_argv, "=");
      if (farg && *farg)
        strcat (my_argv, farg);
      ++(*my_argc);

      cmd_line_list_tmp = (struct line_list *) malloc (sizeof (struct line_list));
      cmd_line_list_tmp->next = cmd_line_list;
      cmd_line_list = cmd_line_list_tmp;
      cmd_line_list->string_arg = gengetopt_strdup(my_argv);
    } /* while */

  if (file)
    fclose(file);
  return result;
}

int
cmdline_parser_configfile (char * const filename,
                           struct gengetopt_args_info *args_info,
                           int override, int initialize, int check_required)
{
  int i, result;
  int my_argc = 1;
  char **my_argv_arg;
  char *additional_error;

  /* store the program name */
  cmd_line_list_tmp = (struct line_list *) malloc (sizeof (struct line_list));
  cmd_line_list_tmp->next = cmd_line_list;
  cmd_line_list = cmd_line_list_tmp;
  cmd_line_list->string_arg = gengetopt_strdup (CMDLINE_PARSER_PACKAGE);

  result = _cmdline_parser_configfile(filename, &my_argc);

  if (result != EXIT_FAILURE) {
    my_argv_arg = (char **) malloc((my_argc+1) * sizeof(char *));
    cmd_line_list_tmp = cmd_line_list;

    for (i = my_argc - 1; i >= 0; --i) {
      my_argv_arg[i] = cmd_line_list_tmp->string_arg;
      cmd_line_list_tmp = cmd_line_list_tmp->next;
    }

    my_argv_arg[my_argc] = 0;

    additional_error = (char *)malloc(strlen(filename) + strlen(ADDITIONAL_ERROR) + 1);
    strcpy (additional_error, ADDITIONAL_ERROR);
    strcat (additional_error, filename);
    result =
      cmdline_parser_internal (my_argc, my_argv_arg, args_info,
                              override, initialize, check_required,
                              additional_error);

    free (additional_error);
    free (my_argv_arg);
  }

  free_cmd_list();
  if (result == EXIT_FAILURE)
    {
      cmdline_parser_free (args_info);
      exit (EXIT_FAILURE);
    }
  
  return result;
}
